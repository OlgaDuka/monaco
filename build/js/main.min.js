"use strict";var headerFormSelect=".header__search",footerFormSelect=".footer__search";function getNoun(t,e,a,c){var o=t;return t=Math.abs(t),5<=(t%=100)&&t<=20?o+" "+c:1===(t%=10)?o+" "+e:2<=t&&t<=4?o+" "+a:o+" "+c}function makeForm(i){var t=new Date,e=new Date,a=new Date;e.setDate(e.getDate()+1),a.setDate(a.getDate()+2),$("".concat(i," .check-calendar")).datepicker({minDate:t,toggleSelected:!1,dateFormat:"d, MM",position:"bottom center",onSelect:function(t,e,a){if(""===e)a.$el.val("Выберите дату");else{var c=moment(e).format("DD MMMM");a.$el.attr("value",c),a.$el.val(c)}var o=new Date(e);o.setDate(o.getDate()+1);var n=$("".concat(i," .eviction-calendar")).datepicker().data("datepicker");e>=n.date?(n.update("minDate",o),n.selectDate(o),$("".concat(i," .eviction-calendar")).val(moment(o).format("DD MMMM")),$("".concat(i," .eviction-calendar")).attr("value",moment(o).format("DD MMMM"))):(n.update("minDate",o),$("".concat(i," .eviction-calendar")).val(moment(n.date).format("DD MMMM")),$("".concat(i," .eviction-calendar")).attr("value",moment(n.date).format("DD MMMM")))}}),$("".concat(i," .eviction-calendar")).datepicker({minDate:a,toggleSelected:!1,dateFormat:"d, MM",position:"bottom center",onSelect:function(t,e,a){if(""===e)a.$el.val("Выберите дату");else{var c=moment(e).format("DD MMMM");a.$el.attr("value",c),a.$el.val(c)}}});var c=moment();c.locale("ru"),$("".concat(i," .check-calendar")).attr("value",moment(c).add(1,"days").format("DD MMMM")),$("".concat(i," .eviction-calendar")).attr("value",moment(c).add(2,"days").format("DD MMMM")),$("".concat(i," .check-calendar")).datepicker().data("datepicker").selectDate(e),$("".concat(i," .eviction-calendar")).datepicker().data("datepicker").selectDate(a);var o=!1;$("".concat(i," .guest")).click(function(t){o||($("".concat(i," .search__guest-change")).fadeToggle(200),o=!0)}),$(document).mouseup(function(t){var e=$("".concat(i," .search__guest-change"));0===e.has(t.target).length&&o&&(e.fadeOut(),setTimeout(function(){o=!1},200))});var n=$("".concat(i," .adult-sum")),r=$("".concat(i," .adult-plus")),l=$("".concat(i," .adult-minus"));r.click(function(t){var e=n.text();e<6&&(e++,n.text(e)),u()}),l.click(function(t){var e=n.text();1<e&&(e--,n.text(e)),u()});var s=$("".concat(i," .child-sum")),d=$("".concat(i," .child-plus")),m=$("".concat(i," .child-minus"));function u(){var t=parseInt(n.text())+parseInt(s.text()),e=getNoun(t,"гостя","гостей","гостей");return $("".concat(i," .full-sum")).text(e),1===parseInt(n.text())?l.attr("disabled",!0):l.attr("disabled",!1),6===parseInt(n.text())?r.attr("disabled",!0):r.attr("disabled",!1),0===parseInt(s.text())?m.attr("disabled",!0):m.attr("disabled",!1),5===parseInt(s.text())?d.attr("disabled",!0):d.attr("disabled",!1),t}d.click(function(t){var e=s.text();e<5&&(e++,s.text(e)),u()}),m.click(function(t){var e=s.text();0<e&&(e--,s.text(e)),u()}),$("".concat(i," .check")).click(function(t){$("".concat(i," .check-calendar")).data("datepicker").show()}),$("".concat(i," .eviction")).click(function(t){$("".concat(i," .eviction-calendar")).data("datepicker").show()}),$("".concat(i," .search__goto")).click(function(t){var e=$("".concat(i," .check-calendar")).data("datepicker").selectedDates,a=$("".concat(i," .eviction-calendar")).data("datepicker").selectedDates,c=u(),o=moment(e[0]).format("DD.MM.YYYY"),n=moment(a[0]).format("DD.MM.YYYY"),r="https://ostrovok.ru/hotel/united_arab_emirates/abu_dhabi/?q=453&dates=".concat(o,"-").concat(n,"&guests=").concat(c);window.open(r,"_blank")})}makeForm(headerFormSelect),makeForm(footerFormSelect);var limit=$(window).height()/4,backToTop=$("#up-btn");$(window).scroll(function(){$(this).scrollTop()>limit?backToTop.fadeIn():backToTop.fadeOut()}),backToTop.click(function(){return $("body, html").animate({scrollTop:0},100),!1});var TABLET_WIDTH=767,DESKTOP_WIDTH=1189;$(".advantages__slider").slick({slidesToShow:1,slidesToScroll:1,arrows:!1,dots:!0,mobileFirst:!0,responsive:[{breakpoint:TABLET_WIDTH,settings:"unslick"}]}),$(".transport__slider").slick({slidesToShow:1,slidesToScroll:1,arrows:!1,dots:!0,mobileFirst:!0,responsive:[{breakpoint:TABLET_WIDTH,settings:"unslick"}]}),$(".lifehack__slider").slick({slidesToShow:1,slidesToScroll:1,arrows:!1,dots:!0,mobileFirst:!0,responsive:[{breakpoint:TABLET_WIDTH,settings:"unslick"}]}),$(".stop__slider").slick({slidesToShow:1,slidesToScroll:1,arrows:!1,dots:!0,mobileFirst:!0,responsive:[{breakpoint:TABLET_WIDTH,settings:"unslick"}]});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZvcm0uanMiLCJzY3JvbGwuanMiLCJzbGlkZXIuanMiXSwibmFtZXMiOlsiaGVhZGVyRm9ybVNlbGVjdCIsImZvb3RlckZvcm1TZWxlY3QiLCJnZXROb3VuIiwibnVtYmVyIiwib25lIiwidHdvIiwiZml2ZSIsImluaXROdW1iZXIiLCJNYXRoIiwiYWJzIiwibWFrZUZvcm0iLCJzZWxlY3Rpb24iLCJjdXJEYXRlIiwiRGF0ZSIsImNoZWNrRGF5IiwiZXZpY3REYXkiLCJzZXREYXRlIiwiZ2V0RGF0ZSIsIiQiLCJjb25jYXQiLCJkYXRlcGlja2VyIiwibWluRGF0ZSIsInRvZ2dsZVNlbGVjdGVkIiwiZGF0ZUZvcm1hdCIsInBvc2l0aW9uIiwib25TZWxlY3QiLCJmZCIsImQiLCJwaWNrZXJzIiwiJGVsIiwidmFsIiwiZGF0ZSIsIm1vbWVudCIsImZvcm1hdCIsImF0dHIiLCJ1cGRNaW4iLCJkYXRhIiwidXBkYXRlIiwic2VsZWN0RGF0ZSIsImRlZkRheSIsImxvY2FsZSIsImFkZCIsIm9wZW5lZCIsImNsaWNrIiwiZSIsImZhZGVUb2dnbGUiLCJkb2N1bWVudCIsIm1vdXNldXAiLCJjb250YWluZXIiLCJoYXMiLCJ0YXJnZXQiLCJsZW5ndGgiLCJmYWRlT3V0Iiwic2V0VGltZW91dCIsImFkdWx0U3VtIiwiYWR1bHRQbHVzIiwiYWR1bHRNaW51cyIsIm51bSIsInRleHQiLCJjYWxjU3VtT2ZHdWVzdHMiLCJjaGlsZFN1bSIsImNoaWxkUGx1cyIsImNoaWxkTWludXMiLCJmdWxsU3VtIiwicGFyc2VJbnQiLCJjb25jYXRTdHJpbmciLCJzaG93IiwiY2hlY2tEYXRhIiwic2VsZWN0ZWREYXRlcyIsImV2aWN0RGF0YSIsImd1ZXN0cyIsImZvcm1hdGVkQ2hlY2siLCJmb3JtYXRlZEV2aWN0IiwiY29tcGFyZVN0cmluZyIsIndpbmRvdyIsIm9wZW4iLCJsaW1pdCIsImhlaWdodCIsImJhY2tUb1RvcCIsInNjcm9sbCIsInRoaXMiLCJzY3JvbGxUb3AiLCJmYWRlSW4iLCJhbmltYXRlIiwiVEFCTEVUX1dJRFRIIiwiREVTS1RPUF9XSURUSCIsInNsaWNrIiwic2xpZGVzVG9TaG93Iiwic2xpZGVzVG9TY3JvbGwiLCJhcnJvd3MiLCJkb3RzIiwibW9iaWxlRmlyc3QiLCJyZXNwb25zaXZlIiwiYnJlYWtwb2ludCIsInNldHRpbmdzIl0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxpQkFBQSxrQkFDQUMsaUJBQUEsa0JBTUEsU0FBQUMsUUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FDQSxJQUFBQyxFQUFBSixFQUdBLE9BRkFBLEVBQUFLLEtBQUFDLElBQUFOLEdBRUEsSUFEQUEsR0FBQSxNQUNBQSxHQUFBLEdBQ0FJLEVBQUEsSUFBQUQsRUFHQSxLQURBSCxHQUFBLElBRUFJLEVBQUEsSUFBQUgsRUFFQSxHQUFBRCxHQUFBQSxHQUFBLEVBQ0FJLEVBQUEsSUFBQUYsRUFFQUUsRUFBQSxJQUFBRCxFQU9BLFNBQUFJLFNBQUFDLEdBQ0EsSUFBQUMsRUFBQSxJQUFBQyxLQUNBQyxFQUFBLElBQUFELEtBQ0FFLEVBQUEsSUFBQUYsS0FDQUMsRUFBQUUsUUFBQUYsRUFBQUcsVUFBQSxHQUNBRixFQUFBQyxRQUFBRCxFQUFBRSxVQUFBLEdBR0FDLEVBQUEsR0FBQUMsT0FBQVIsRUFBQSxxQkFBQVMsV0FBQSxDQUNBQyxRQUFBVCxFQUNBVSxnQkFBQSxFQUNBQyxXQUFBLFFBQ0FDLFNBQUEsZ0JBQ0FDLFNBQUEsU0FBQUMsRUFBQUMsRUFBQUMsR0FDQSxHQUFBLEtBQUFELEVBQ0FDLEVBQUFDLElBQUFDLElBQUEscUJBQ0EsQ0FDQSxJQUFBQyxFQUFBQyxPQUFBTCxHQUFBTSxPQUFBLFdBQ0FMLEVBQUFDLElBQUFLLEtBQUEsUUFBQUgsR0FDQUgsRUFBQUMsSUFBQUMsSUFBQUMsR0FHQSxJQUFBSSxFQUFBLElBQUF0QixLQUFBYyxHQUNBUSxFQUFBbkIsUUFBQW1CLEVBQUFsQixVQUFBLEdBR0EsSUFBQUcsRUFBQUYsRUFBQSxHQUFBQyxPQUFBUixFQUFBLHdCQUFBUyxhQUFB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QUFBLFlBQUFyRCxPQUFBbUQsR0FHQUksT0FBQUMsS0FBQUYsRUFBQSxZQWpPQS9ELFNBQUFWLGtCQUNBVSxTQUFBVCxrQkNMQSxJQUFBMkUsTUFBQTFELEVBQUF3RCxRQUFBRyxTQUFBLEVBQ0FDLFVBQUE1RCxFQUFBLFdBSUFBLEVBQUF3RCxRQUFBSyxPQUFBLFdBQ0E3RCxFQUFBOEQsTUFBQUMsWUFBQUwsTUFDQUUsVUFBQUksU0FFQUosVUFBQTFCLFlBS0EwQixVQUFBbkMsTUFBQSxXQUVBLE9BREF6QixFQUFBLGNBQUFpRSxRQUFBLENBQUFGLFVBQUEsR0FBQSxNQUNBLElDaEJBLElBQUFHLGFBQUEsSUFDQUMsY0FBQSxLQUVBbkUsRUFBQSx1QkFBQW9FLE1BQUEsQ0FDQUMsYUFBQSxFQUNBQyxlQUFBLEVBQ0FDLFFBQUEsRUFDQUMsTUFBQSxFQUNBQyxhQUFBLEVBQ0FDLFdBQUEsQ0FDQSxDQUNBQyxXQUFBVCxhQUNBVSxTQUFBLGNBS0E1RSxFQUFBLHNCQUFBb0UsTUFBQSxDQUNBQyxhQUFBLEVBQ0FDLGVBQUEsRUFDQUMsUUFBQSxFQUNBQyxNQUFBLEVBQ0FDLGFBQUEsRUFDQUMsV0FBQSxDQUNBLENBQ0FDLFdBQUFULGFBQ0FVLFNBQUEsY0FLQTVFLEVBQUEscUJBQUFvRSxNQUFBLENBQ0FDLGFBQUEsRUFDQUMsZUFBQSxFQUNBQyxRQUFBLEVBQ0FDLE1BQUEsRUFDQUMsYUFBQSxFQUNBQyxXQUFBLENBQ0EsQ0FDQUMsV0FBQVQsYUFDQVUsU0FBQSxjQUtBNUUsRUFBQSxpQkFBQW9FLE1BQUEsQ0FDQUMsYUFBQSxFQUNBQyxlQUFBLEVBQ0FDLFFBQUEsRUFDQUMsTUFBQSxFQUNBQyxhQUFBLEVBQ0FDLFdBQUEsQ0FDQSxDQUNBQyxXQUFBVCxhQUNBVSxTQUFBIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIgIC8vINCk0L7RgNC80LjRgNGD0LXQvCDRhNC+0YDQvNGLINC30LDQutCw0LfRi1xuICBjb25zdCBoZWFkZXJGb3JtU2VsZWN0ID0gJy5oZWFkZXJfX3NlYXJjaCc7XG4gIGNvbnN0IGZvb3RlckZvcm1TZWxlY3QgPSAnLmZvb3Rlcl9fc2VhcmNoJztcblxuICBtYWtlRm9ybShoZWFkZXJGb3JtU2VsZWN0KTtcbiAgbWFrZUZvcm0oZm9vdGVyRm9ybVNlbGVjdCk7XG5cbi8vINCh0LrQu9C+0L3QtdC90LjQtVxuZnVuY3Rpb24gZ2V0Tm91bihudW1iZXIsIG9uZSwgdHdvLCBmaXZlKSB7XG4gIGNvbnN0IGluaXROdW1iZXIgPSBudW1iZXJcbiAgbnVtYmVyID0gTWF0aC5hYnMobnVtYmVyKVxuICBudW1iZXIgJT0gMTAwXG4gIGlmIChudW1iZXIgPj0gNSAmJiBudW1iZXIgPD0gMjApIHtcbiAgICByZXR1cm4gaW5pdE51bWJlciArICcgJyArIGZpdmVcbiAgfVxuICBudW1iZXIgJT0gMTBcbiAgaWYgKG51bWJlciA9PT0gMSkge1xuICAgIHJldHVybiBpbml0TnVtYmVyICsgJyAnICsgb25lXG4gIH1cbiAgaWYgKG51bWJlciA+PSAyICYmIG51bWJlciA8PSA0KSB7XG4gICAgcmV0dXJuIGluaXROdW1iZXIgKyAnICcgKyB0d29cbiAgfVxuICByZXR1cm4gaW5pdE51bWJlciArICcgJyArIGZpdmVcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAvL1xuICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgINCk0L7RgNC80LAg0L/QvtC40YHQutCwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAvL1xuXG4gIGZ1bmN0aW9uIG1ha2VGb3JtKHNlbGVjdGlvbikge1xuICAgIGNvbnN0IGN1ckRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IGNoZWNrRGF5ID0gbmV3IERhdGUoKTtcbiAgICBjb25zdCBldmljdERheSA9IG5ldyBEYXRlKCk7XG4gICAgY2hlY2tEYXkuc2V0RGF0ZShjaGVja0RheS5nZXREYXRlKCkgKyAxKTtcbiAgICBldmljdERheS5zZXREYXRlKGV2aWN0RGF5LmdldERhdGUoKSArIDIpO1xuXG4gICAgLy8gKioqKioqKioqKioqKioqICoq0KHQuNC90YXRgNC+0L3QuNC30LDRhtC40Y8g0LrQsNC70LXQvdC00LDRgNC10LkgKioqKioqKioqKioqKioqKioqKioqKioqIC8vXG4gICAgJChgJHtzZWxlY3Rpb259IC5jaGVjay1jYWxlbmRhcmApLmRhdGVwaWNrZXIoe1xuICAgICAgbWluRGF0ZTogY3VyRGF0ZSxcbiAgICAgIHRvZ2dsZVNlbGVjdGVkOiBmYWxzZSxcbiAgICAgIGRhdGVGb3JtYXQ6ICdkLCBNTScsXG4gICAgICBwb3NpdGlvbjogXCJib3R0b20gY2VudGVyXCIsXG4gICAgICBvblNlbGVjdDogZnVuY3Rpb24gKGZkLCBkLCBwaWNrZXJzKSB7XG4gICAgICAgIGlmIChkID09PSAnJykge1xuICAgICAgICAgIHBpY2tlcnMuJGVsLnZhbCgn0JLRi9Cx0LXRgNC40YLQtSDQtNCw0YLRgycpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnN0IGRhdGUgPSBtb21lbnQoZCkuZm9ybWF0KCdERCBNTU1NJyk7XG4gICAgICAgICAgcGlja2Vycy4kZWwuYXR0cigndmFsdWUnLCBkYXRlKTtcbiAgICAgICAgICBwaWNrZXJzLiRlbC52YWwoZGF0ZSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB1cGRNaW4gPSBuZXcgRGF0ZShkKTtcbiAgICAgICAgdXBkTWluLnNldERhdGUodXBkTWluLmdldERhdGUoKSArIDEpO1xuXG4gICAgICAgIC8vINCc0LXQvdGP0LXQvCDQvNC40L0g0LfQvdCw0YfQtdC90LjQtSDQsiDQutCw0LvQtdC90LTQsNGA0LUg0LLRi9GB0LXQu9C10L3QuNGPXG4gICAgICAgIGNvbnN0IGRhdGVwaWNrZXIgPSAkKGAke3NlbGVjdGlvbn0gLmV2aWN0aW9uLWNhbGVuZGFyYCkuZGF0ZXBpY2tlcigpLmRhdGEoJ2RhdGVwaWNrZXInKTtcblxuICAgICAgICBpZiAoZCA+PSBkYXRlcGlja2VyLmRhdGUpIHtcbiAgICAgICAgICBkYXRlcGlja2VyLnVwZGF0ZSgnbWluRGF0ZScsIHVwZE1pbik7XG4gICAgICAgICAgZGF0ZXBpY2tlci5zZWxlY3REYXRlKHVwZE1pbik7XG4gICAgICAgICAgJChgJHtzZWxlY3Rpb259IC5ldmljdGlvbi1jYWxlbmRhcmApLnZhbChtb21lbnQodXBkTWluKS5mb3JtYXQoJ0REIE1NTU0nKSlcbiAgICAgICAgICAkKGAke3NlbGVjdGlvbn0gLmV2aWN0aW9uLWNhbGVuZGFyYCkuYXR0cigndmFsdWUnLCBtb21lbnQodXBkTWluKS5mb3JtYXQoJ0REIE1NTU0nKSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkYXRlcGlja2VyLnVwZGF0ZSgnbWluRGF0ZScsIHVwZE1pbik7XG4gICAgICAgICAgJChgJHtzZWxlY3Rpb259IC5ldmljdGlvbi1jYWxlbmRhcmApLnZhbChtb21lbnQoZGF0ZXBpY2tlci5kYXRlKS5mb3JtYXQoJ0REIE1NTU0nKSlcbiAgICAgICAgICAkKGAke3NlbGVjdGlvbn0gLmV2aWN0aW9uLWNhbGVuZGFyYCkuYXR0cigndmFsdWUnLCBtb21lbnQoZGF0ZXBpY2tlci5kYXRlKS5mb3JtYXQoJ0REIE1NTU0nKSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgJChgJHtzZWxlY3Rpb259IC5ldmljdGlvbi1jYWxlbmRhcmApLmRhdGVwaWNrZXIoe1xuICAgICAgbWluRGF0ZTogZXZpY3REYXksXG4gICAgICB0b2dnbGVTZWxlY3RlZDogZmFsc2UsXG4gICAgICBkYXRlRm9ybWF0OiAnZCwgTU0nLFxuICAgICAgcG9zaXRpb246IFwiYm90dG9tIGNlbnRlclwiLFxuICAgICAgb25TZWxlY3Q6IGZ1bmN0aW9uIChmZCwgZCwgcGlja2Vycykge1xuICAgICAgICBpZiAoZCA9PT0gJycpIHtcbiAgICAgICAgICBwaWNrZXJzLiRlbC52YWwoJ9CS0YvQsdC10YDQuNGC0LUg0LTQsNGC0YMnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zdCBkYXRlID0gbW9tZW50KGQpLmZvcm1hdCgnREQgTU1NTScpO1xuICAgICAgICAgIHBpY2tlcnMuJGVsLmF0dHIoJ3ZhbHVlJywgZGF0ZSk7XG4gICAgICAgICAgcGlja2Vycy4kZWwudmFsKGRhdGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAvL1xuXG4gICAgLy8g0JfQvdCw0YfQtdC90LjRjyDQv9C+LdGD0LzQvtC70YfQsNC90LjRjlxuICAgIGNvbnN0IGRlZkRheSA9IG1vbWVudCgpO1xuXG4gICAgZGVmRGF5LmxvY2FsZSgncnUnKVxuICAgICQoYCR7c2VsZWN0aW9ufSAuY2hlY2stY2FsZW5kYXJgKS5hdHRyKCd2YWx1ZScsIG1vbWVudChkZWZEYXkpLmFkZCgxLCAnZGF5cycpLmZvcm1hdCgnREQgTU1NTScpKTtcbiAgICAkKGAke3NlbGVjdGlvbn0gLmV2aWN0aW9uLWNhbGVuZGFyYCkuYXR0cigndmFsdWUnLCBtb21lbnQoZGVmRGF5KS5hZGQoMiwgJ2RheXMnKS5mb3JtYXQoJ0REIE1NTU0nKSk7XG5cblxuICAgIGNvbnN0IGNoZWNrQ2FsZW5kYXIgPSAkKGAke3NlbGVjdGlvbn0gLmNoZWNrLWNhbGVuZGFyYCkuZGF0ZXBpY2tlcigpLmRhdGEoJ2RhdGVwaWNrZXInKTtcbiAgICBjaGVja0NhbGVuZGFyLnNlbGVjdERhdGUoY2hlY2tEYXkpO1xuXG4gICAgY29uc3QgZXZpY3Rpb25DYWxlbmRhciA9ICQoYCR7c2VsZWN0aW9ufSAuZXZpY3Rpb24tY2FsZW5kYXJgKS5kYXRlcGlja2VyKCkuZGF0YSgnZGF0ZXBpY2tlcicpO1xuICAgIGV2aWN0aW9uQ2FsZW5kYXIuc2VsZWN0RGF0ZShldmljdERheSk7XG5cbiAgICAvLyAqKioqKioqKioqKiog0JrQvtC70LjRh9C10YHRgtCy0L4g0LPQvtGB0YLQtdC5ICoqKioqKioqKioqKioqKiogLy9cbiAgICAvLyDQktGL0L/QsNC00LDRjtGJ0LXQtSDQvNC10L3RjlxuICAgIGxldCBvcGVuZWQgPSBmYWxzZTtcblxuICAgICQoYCR7c2VsZWN0aW9ufSAuZ3Vlc3RgKS5jbGljaygoZSkgPT4ge1xuICAgICAgaWYgKCFvcGVuZWQpIHtcbiAgICAgICAgJChgJHtzZWxlY3Rpb259IC5zZWFyY2hfX2d1ZXN0LWNoYW5nZWApLmZhZGVUb2dnbGUoMjAwKTtcbiAgICAgICAgb3BlbmVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgLy8g0KHQutGA0YvRgtC40LUg0L/RgNC4INC60LvQuNC60LUg0LLQvdC1INC+0LrQvdCwXG4gICAgJChkb2N1bWVudCkubW91c2V1cChmdW5jdGlvbiAoZSkge1xuICAgICAgdmFyIGNvbnRhaW5lciA9ICQoYCR7c2VsZWN0aW9ufSAuc2VhcmNoX19ndWVzdC1jaGFuZ2VgKTtcbiAgICAgIGlmIChjb250YWluZXIuaGFzKGUudGFyZ2V0KS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgaWYgKG9wZW5lZCkge1xuICAgICAgICAgIGNvbnRhaW5lci5mYWRlT3V0KCk7XG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBvcGVuZWQgPSBmYWxzZTtcbiAgICAgICAgICB9LCAyMDApXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vINCS0LfRgNC+0YHQu9GL0LVcbiAgICBjb25zdCBhZHVsdFN1bSA9ICQoYCR7c2VsZWN0aW9ufSAuYWR1bHQtc3VtYCk7XG4gICAgY29uc3QgYWR1bHRQbHVzID0gJChgJHtzZWxlY3Rpb259IC5hZHVsdC1wbHVzYCk7XG4gICAgY29uc3QgYWR1bHRNaW51cyA9ICQoYCR7c2VsZWN0aW9ufSAuYWR1bHQtbWludXNgKTtcblxuICAgIGFkdWx0UGx1cy5jbGljaygoZSkgPT4ge1xuICAgICAgbGV0IG51bSA9IGFkdWx0U3VtLnRleHQoKVxuICAgICAgaWYgKG51bSA8IDYpIHtcbiAgICAgICAgbnVtKys7XG4gICAgICAgIGFkdWx0U3VtLnRleHQobnVtKVxuICAgICAgfVxuXG4gICAgICBjYWxjU3VtT2ZHdWVzdHMoKTtcbiAgICB9KTtcblxuICAgIGFkdWx0TWludXMuY2xpY2soKGUpID0+IHtcbiAgICAgIGxldCBudW0gPSBhZHVsdFN1bS50ZXh0KClcbiAgICAgIGlmIChudW0gPiAxKSB7XG4gICAgICAgIG51bS0tO1xuICAgICAgICBhZHVsdFN1bS50ZXh0KG51bSlcbiAgICAgIH1cblxuICAgICAgY2FsY1N1bU9mR3Vlc3RzKCk7XG4gICAgfSk7XG5cbiAgICAvLyDQlNC10YLQuFxuICAgIGNvbnN0IGNoaWxkU3VtID0gJChgJHtzZWxlY3Rpb259IC5jaGlsZC1zdW1gKTtcbiAgICBjb25zdCBjaGlsZFBsdXMgPSAkKGAke3NlbGVjdGlvbn0gLmNoaWxkLXBsdXNgKTtcbiAgICBjb25zdCBjaGlsZE1pbnVzID0gJChgJHtzZWxlY3Rpb259IC5jaGlsZC1taW51c2ApO1xuXG4gICAgY2hpbGRQbHVzLmNsaWNrKChlKSA9PiB7XG4gICAgICBsZXQgbnVtID0gY2hpbGRTdW0udGV4dCgpXG4gICAgICBpZiAobnVtIDwgNSkge1xuICAgICAgICBudW0rKztcbiAgICAgICAgY2hpbGRTdW0udGV4dChudW0pXG4gICAgICB9XG5cbiAgICAgIGNhbGNTdW1PZkd1ZXN0cygpO1xuICAgIH0pO1xuXG4gICAgY2hpbGRNaW51cy5jbGljaygoZSkgPT4ge1xuICAgICAgbGV0IG51bSA9IGNoaWxkU3VtLnRleHQoKVxuICAgICAgaWYgKG51bSA+IDApIHtcbiAgICAgICAgbnVtLS07XG4gICAgICAgIGNoaWxkU3VtLnRleHQobnVtKVxuICAgICAgfVxuXG4gICAgICBjYWxjU3VtT2ZHdWVzdHMoKTtcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIGNhbGNTdW1PZkd1ZXN0cygpIHtcbiAgICAgIGNvbnN0IGZ1bGxTdW0gPSBwYXJzZUludChhZHVsdFN1bS50ZXh0KCkpICsgcGFyc2VJbnQoY2hpbGRTdW0udGV4dCgpKTtcbiAgICAgIGNvbnN0IGNvbmNhdFN0cmluZyA9IGdldE5vdW4oZnVsbFN1bSwgJ9Cz0L7RgdGC0Y8nLCAn0LPQvtGB0YLQtdC5JywgJ9Cz0L7RgdGC0LXQuScpO1xuICAgICAgJChgJHtzZWxlY3Rpb259IC5mdWxsLXN1bWApLnRleHQoY29uY2F0U3RyaW5nKTtcblxuICAgICAgaWYgKHBhcnNlSW50KGFkdWx0U3VtLnRleHQoKSkgPT09IDEpIHtcbiAgICAgICAgYWR1bHRNaW51cy5hdHRyKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYWR1bHRNaW51cy5hdHRyKCdkaXNhYmxlZCcsIGZhbHNlKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHBhcnNlSW50KGFkdWx0U3VtLnRleHQoKSkgPT09IDYpIHtcbiAgICAgICAgYWR1bHRQbHVzLmF0dHIoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhZHVsdFBsdXMuYXR0cignZGlzYWJsZWQnLCBmYWxzZSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChwYXJzZUludChjaGlsZFN1bS50ZXh0KCkpID09PSAwKSB7XG4gICAgICAgIGNoaWxkTWludXMuYXR0cignZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNoaWxkTWludXMuYXR0cignZGlzYWJsZWQnLCBmYWxzZSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChwYXJzZUludChjaGlsZFN1bS50ZXh0KCkpID09PSA1KSB7XG4gICAgICAgIGNoaWxkUGx1cy5hdHRyKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2hpbGRQbHVzLmF0dHIoJ2Rpc2FibGVkJywgZmFsc2UpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZnVsbFN1bVxuICAgIH1cblxuXG4gICAgJChgJHtzZWxlY3Rpb259IC5jaGVja2ApLmNsaWNrKChlKSA9PiB7XG4gICAgICAkKGAke3NlbGVjdGlvbn0gLmNoZWNrLWNhbGVuZGFyYCkuZGF0YSgnZGF0ZXBpY2tlcicpLnNob3coKTtcbiAgICB9KVxuXG4gICAgJChgJHtzZWxlY3Rpb259IC5ldmljdGlvbmApLmNsaWNrKChlKSA9PiB7XG4gICAgICAkKGAke3NlbGVjdGlvbn0gLmV2aWN0aW9uLWNhbGVuZGFyYCkuZGF0YSgnZGF0ZXBpY2tlcicpLnNob3coKTtcbiAgICB9KVxuXG4gICAgLy8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAvL1xuXG4gICAgJChgJHtzZWxlY3Rpb259IC5zZWFyY2hfX2dvdG9gKS5jbGljaygoZSkgPT4ge1xuICAgICAgY29uc3QgY2hlY2tEYXRhID0gJChgJHtzZWxlY3Rpb259IC5jaGVjay1jYWxlbmRhcmApLmRhdGEoJ2RhdGVwaWNrZXInKS5zZWxlY3RlZERhdGVzO1xuICAgICAgY29uc3QgZXZpY3REYXRhID0gJChgJHtzZWxlY3Rpb259IC5ldmljdGlvbi1jYWxlbmRhcmApLmRhdGEoJ2RhdGVwaWNrZXInKS5zZWxlY3RlZERhdGVzO1xuICAgICAgY29uc3QgZ3Vlc3RzID0gY2FsY1N1bU9mR3Vlc3RzKCk7XG5cbiAgICAgIGNvbnN0IGZvcm1hdGVkQ2hlY2sgPSBtb21lbnQoY2hlY2tEYXRhWzBdKS5mb3JtYXQoJ0RELk1NLllZWVknKTtcbiAgICAgIGNvbnN0IGZvcm1hdGVkRXZpY3QgPSBtb21lbnQoZXZpY3REYXRhWzBdKS5mb3JtYXQoJ0RELk1NLllZWVknKTtcbiAgICAgIGNvbnN0IGNvbXBhcmVTdHJpbmcgPSBgaHR0cHM6Ly9vc3Ryb3Zvay5ydS9ob3RlbC91bml0ZWRfYXJhYl9lbWlyYXRlcy9hYnVfZGhhYmkvP3E9NDUzJmRhdGVzPSR7Zm9ybWF0ZWRDaGVja30tJHtmb3JtYXRlZEV2aWN0fSZndWVzdHM9JHtndWVzdHN9YFxuXG4gICAgICAvLyB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGNvbXBhcmVTdHJpbmc7XG4gICAgICB3aW5kb3cub3Blbihjb21wYXJlU3RyaW5nLCAnX2JsYW5rJyk7XG4gICAgICAvLyBjb25zb2xlLmxvZyhmb3JtYXRlZENoZWNrKVxuICAgICAgLy8gY29uc29sZS5sb2coZm9ybWF0ZWRFdmljdClcbiAgICAgIC8vIGNvbnNvbGUubG9nKGd1ZXN0cylcbiAgICAgIC8vIGNvbnNvbGUubG9nKGNvbXBhcmVTdHJpbmcpXG4gICAgfSlcbiAgfVxuIiwiICBjb25zdCBsaW1pdCA9ICQod2luZG93KS5oZWlnaHQoKSAvIDQ7XG4gIGNvbnN0IGJhY2tUb1RvcCA9ICQoJyN1cC1idG4nKTtcblxuICAvLyBBcHBlYXJpbmcgYW5kIGRpc2FwcGVhcmluZyBvZiB0aGUgJ3VwJyBidXR0b24gb24gdGhlIGZpcnN0IHNjcmVlblxuICAvLyBhbmQgZml4ZWQgbWVudSBvbiB0b3Agc2NyZWVuXG4gICQod2luZG93KS5zY3JvbGwoZnVuY3Rpb24gKCkge1xuICAgIGlmICgkKHRoaXMpLnNjcm9sbFRvcCgpID4gbGltaXQpIHtcbiAgICAgIGJhY2tUb1RvcC5mYWRlSW4oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYmFja1RvVG9wLmZhZGVPdXQoKTtcbiAgICB9XG4gIH0pO1xuXG4gICAvLyBTb2Z0IHNjcm9sbCB0byB0aGUgdG9wXG4gIGJhY2tUb1RvcC5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgJCgnYm9keSwgaHRtbCcpLmFuaW1hdGUoe3Njcm9sbFRvcDogMH0sIDEwMCk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9KTtcbiIsImNvbnN0IFRBQkxFVF9XSURUSCA9IDc2OCAtIDE7XG5jb25zdCBERVNLVE9QX1dJRFRIID0gMTE5MCAtIDE7XG5cbiQoJy5hZHZhbnRhZ2VzX19zbGlkZXInKS5zbGljayh7XG4gIHNsaWRlc1RvU2hvdzogMSxcbiAgc2xpZGVzVG9TY3JvbGw6IDEsXG4gIGFycm93czogZmFsc2UsXG4gIGRvdHM6IHRydWUsXG4gIG1vYmlsZUZpcnN0OiB0cnVlLFxuICByZXNwb25zaXZlOiBbXG4gICAge1xuICAgICAgYnJlYWtwb2ludDogVEFCTEVUX1dJRFRILFxuICAgICAgc2V0dGluZ3M6ICd1bnNsaWNrJ1xuICAgIH1cbiAgXVxufSk7XG5cbiQoJy50cmFuc3BvcnRfX3NsaWRlcicpLnNsaWNrKHtcbiAgc2xpZGVzVG9TaG93OiAxLFxuICBzbGlkZXNUb1Njcm9sbDogMSxcbiAgYXJyb3dzOiBmYWxzZSxcbiAgZG90czogdHJ1ZSxcbiAgbW9iaWxlRmlyc3Q6IHRydWUsXG4gIHJlc3BvbnNpdmU6IFtcbiAgICB7XG4gICAgICBicmVha3BvaW50OiBUQUJMRVRfV0lEVEgsXG4gICAgICBzZXR0aW5nczogJ3Vuc2xpY2snXG4gICAgfVxuICBdXG59KTtcblxuJCgnLmxpZmVoYWNrX19zbGlkZXInKS5zbGljayh7XG4gIHNsaWRlc1RvU2hvdzogMSxcbiAgc2xpZGVzVG9TY3JvbGw6IDEsXG4gIGFycm93czogZmFsc2UsXG4gIGRvdHM6IHRydWUsXG4gIG1vYmlsZUZpcnN0OiB0cnVlLFxuICByZXNwb25zaXZlOiBbXG4gICAge1xuICAgICAgYnJlYWtwb2ludDogVEFCTEVUX1dJRFRILFxuICAgICAgc2V0dGluZ3M6ICd1bnNsaWNrJ1xuICAgIH1cbiAgXVxufSk7XG5cbiQoJy5zdG9wX19zbGlkZXInKS5zbGljayh7XG4gIHNsaWRlc1RvU2hvdzogMSxcbiAgc2xpZGVzVG9TY3JvbGw6IDEsXG4gIGFycm93czogZmFsc2UsXG4gIGRvdHM6IHRydWUsXG4gIG1vYmlsZUZpcnN0OiB0cnVlLFxuICByZXNwb25zaXZlOiBbXG4gICAge1xuICAgICAgYnJlYWtwb2ludDogVEFCTEVUX1dJRFRILFxuICAgICAgc2V0dGluZ3M6ICd1bnNsaWNrJ1xuICAgIH1cbiAgXVxufSk7XG4iXX0=
