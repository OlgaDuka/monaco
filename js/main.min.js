"use strict";var headerFormSelect=".header__search",footerFormSelect=".footer__search";function getNoun(e,t,a,r){var o=e;return e=Math.abs(e),5<=(e%=100)&&e<=20?o+" "+r:1===(e%=10)?o+" "+t:2<=e&&e<=4?o+" "+a:o+" "+r}function makeForm(s){var e=new Date,t=new Date,a=new Date;t.setDate(t.getDate()+1),a.setDate(a.getDate()+2),$("".concat(s," .check-calendar")).datepicker({minDate:e,toggleSelected:!1,dateFormat:"d, MM",position:"bottom center",onSelect:function(e,t,a){if(""===t)a.$el.val("Выберите дату");else{var r=moment(t).format("DD MMMM");a.$el.attr("value",r),a.$el.val(r)}var o=new Date(t);o.setDate(o.getDate()+1);var c=$("".concat(s," .eviction-calendar")).datepicker().data("datepicker");t>=c.date?(c.update("minDate",o),c.selectDate(o),$("".concat(s," .eviction-calendar")).val(moment(o).format("DD MMMM")),$("".concat(s," .eviction-calendar")).attr("value",moment(o).format("DD MMMM"))):(c.update("minDate",o),$("".concat(s," .eviction-calendar")).val(moment(c.date).format("DD MMMM")),$("".concat(s," .eviction-calendar")).attr("value",moment(c.date).format("DD MMMM")))}}),$("".concat(s," .eviction-calendar")).datepicker({minDate:a,toggleSelected:!1,dateFormat:"d, MM",position:"bottom center",onSelect:function(e,t,a){if(""===t)a.$el.val("Выберите дату");else{var r=moment(t).format("DD MMMM");a.$el.attr("value",r),a.$el.val(r)}}});var r=moment();r.locale("ru"),$("".concat(s," .check-calendar")).attr("value",moment(r).add(1,"days").format("DD MMMM")),$("".concat(s," .eviction-calendar")).attr("value",moment(r).add(2,"days").format("DD MMMM")),$("".concat(s," .check-calendar")).datepicker().data("datepicker").selectDate(t),$("".concat(s," .eviction-calendar")).datepicker().data("datepicker").selectDate(a);var o=!1;$("".concat(s," .guest")).click(function(e){o||($("".concat(s," .search__guest-change")).fadeToggle(200),o=!0)}),$(document).mouseup(function(e){var t=$("".concat(s," .search__guest-change"));0===t.has(e.target).length&&o&&(t.fadeOut(),setTimeout(function(){o=!1},200))});var c=$("".concat(s," .adult-sum")),i=$("".concat(s," .adult-plus")),n=$("".concat(s," .adult-minus"));i.click(function(e){var t=c.text();t<6&&(t++,c.text(t)),_()}),n.click(function(e){var t=c.text();1<t&&(t--,c.text(t)),_()});var l=$("".concat(s," .child-sum")),d=$("".concat(s," .child-plus")),m=$("".concat(s," .child-minus"));function _(){var e=parseInt(c.text())+parseInt(l.text()),t=getNoun(e,"гостя","гостей","гостей");return $("".concat(s," .full-sum")).text(t),1===parseInt(c.text())?n.attr("disabled",!0):n.attr("disabled",!1),6===parseInt(c.text())?i.attr("disabled",!0):i.attr("disabled",!1),0===parseInt(l.text())?m.attr("disabled",!0):m.attr("disabled",!1),5===parseInt(l.text())?d.attr("disabled",!0):d.attr("disabled",!1),e}d.click(function(e){var t=l.text();t<5&&(t++,l.text(t)),_()}),m.click(function(e){var t=l.text();0<t&&(t--,l.text(t)),_()}),$("".concat(s," .check")).click(function(e){$("".concat(s," .check-calendar")).data("datepicker").show()}),$("".concat(s," .eviction")).click(function(e){$("".concat(s," .eviction-calendar")).data("datepicker").show()}),$("".concat(s," .search__goto")).click(function(e){var t=$("".concat(s," .check-calendar")).data("datepicker").selectedDates,a=$("".concat(s," .eviction-calendar")).data("datepicker").selectedDates,r=_(),o=moment(t[0]).format("DD.MM.YYYY"),c=moment(a[0]).format("DD.MM.YYYY"),i="https://ostrovok.ru/hotel/united_arab_emirates/abu_dhabi/?q=453&dates=".concat(o,"-").concat(c,"&guests=").concat(r);window.open(i,"_blank")})}makeForm(headerFormSelect),makeForm(footerFormSelect);var feed=new Instafeed({get:"user",userId:14110486070,accessToken:"14110486070.1677ed0.e29f390d542548cc9d383954ff2b2f3a",target:"Instafeed",resolution:"thumbnail",limit:22,template:'<li><img src="{{image}}" /></li>'});feed.run();var limit=$(window).height()/4,backToTop=$("#up-btn");$(window).scroll(function(){$(this).scrollTop()>limit?backToTop.fadeIn():backToTop.fadeOut()}),backToTop.click(function(){return $("body, html").animate({scrollTop:0},100),!1});var TABLET_WIDTH=767,DESKTOP_WIDTH=1189;$(".advantages__slider").slick({slidesToShow:1,slidesToScroll:1,arrows:!1,dots:!0,mobileFirst:!0,responsive:[{breakpoint:TABLET_WIDTH,settings:"unslick"}]}),$(".transport__slider").slick({slidesToShow:1,slidesToScroll:1,arrows:!1,dots:!0,mobileFirst:!0,responsive:[{breakpoint:TABLET_WIDTH,settings:"unslick"}]}),$(".lifehack__slider").slick({slidesToShow:1,slidesToScroll:1,arrows:!1,dots:!0,mobileFirst:!0,responsive:[{breakpoint:TABLET_WIDTH,settings:"unslick"}]}),$(".stop__slider").slick({slidesToShow:1,slidesToScroll:1,arrows:!1,dots:!0,mobileFirst:!0,responsive:[{breakpoint:TABLET_WIDTH,settings:"unslick"}]}),$(".details__slider-for").slick({slidesToShow:1,slidesToScroll:1,initialSlide:2,centerMode:!1,dots:!0,arrows:!1,asNavFor:".details__slider-nav",mobileFirst:!0,responsive:[{breakpoint:TABLET_WIDTH,settings:{slidesToShow:1,centerMode:!0,variableWidth:!0}}]}),$(".details__slider-nav").slick({slidesToShow:4,slidesToScroll:1,initialSlide:2,dots:!1,asNavFor:".details__slider-for",focusOnSelect:!0,variableWidth:!0,mobileFirst:!0,responsive:[{breakpoint:TABLET_WIDTH,settings:{slidesToShow:6,dots:!0}}]});var setSlickParameters=function(e,t){return{mobileFirst:!0,infinite:!0,slidesToShow:1,slidesToScroll:1,variableWidth:!0,dots:!1,prevArrow:$(e),nextArrow:$(t),responsive:[{breakpoint:TABLET_WIDTH,settings:{centerMode:!1}},{breakpoint:DESKTOP_WIDTH,settings:{slidesToShow:1}}]}},better1=setSlickParameters(".better__arrow--prev1",".better__arrow--next1"),better2=setSlickParameters(".better__arrow--prev2",".better__arrow--next2"),better3=setSlickParameters(".better__arrow--prev3",".better__arrow--next3"),better4=setSlickParameters(".better__arrow--prev4",".better__arrow--next4");$(".better__slider--1").slick(better1),$(".better__slider--2").slick(better2),$(".better__slider--3").slick(better3),$(".better__slider--4").slick(better4);var menu=document.querySelector(".better__menu"),betterMenuItems=menu.querySelectorAll(".better__menu-item"),betterSliders=document.querySelectorAll(".better__slider");$(".better__menu-item").click(function(e){if(!$(this).hasClass("better__menu-item--active")){var t=$(this).data().num,a=$('.better__slider[data-num="'+t+'"]'),r=$('.better__controls[data-num="'+t+'"]');$(".better__slider").each(function(e,t){$(t).removeClass("better__slider--active")}),$(".better__controls").each(function(e,t){$(t).removeClass("better__controls--active")}),$(".better__menu-item").each(function(e,t){$(t).removeClass("better__menu-item--active")}),$(this).addClass("better__menu-item--active"),a.addClass("better__slider--active"),r.addClass("better__controls--active"),a.slick("refresh")}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZvcm0uanMiLCJpbnN0YS5qcyIsInNjcm9sbC5qcyIsInNsaWRlci5qcyJdLCJuYW1lcyI6WyJoZWFkZXJGb3JtU2VsZWN0IiwiZm9vdGVyRm9ybVNlbGVjdCIsImdldE5vdW4iLCJudW1iZXIiLCJvbmUiLCJ0d28iLCJmaXZlIiwiaW5pdE51bWJlciIsIk1hdGgiLCJhYnMiLCJtYWtlRm9ybSIsInNlbGVjdGlvbiIsImN1ckRhdGUiLCJEYXRlIiwiY2hlY2tEYXkiLCJldmljdERheSIsInNldERhdGUiLCJnZXREYXRlIiwiJCIsImNvbmNhdCIsImRhdGVwaWNrZXIiLCJtaW5EYXRlIiwidG9nZ2xlU2VsZWN0ZWQiLCJkYXRlRm9ybWF0IiwicG9zaXRpb24iLCJvblNlbGVjdCIsImZkIiwiZCIsInBpY2tlcnMiLCIkZWwiLCJ2YWwiLCJkYXRlIiwibW9tZW50IiwiZm9ybWF0IiwiYXR0ciIsInVwZE1pbiIsImRhdGEiLCJ1cGRhdGUiLCJzZWxlY3REYXRlIiwiZGVmRGF5IiwibG9jYWxlIiwiYWRkIiwib3BlbmVkIiwiY2xpY2siLCJlIiwiZmFkZVRvZ2dsZSIsImRvY3VtZW50IiwibW91c2V1cCIsImNvbnRhaW5lciIsImhhcyIsInRhcmdldCIsImxlbmd0aCIsImZhZGVPdXQiLCJzZXRUaW1lb3V0IiwiYWR1bHRTdW0iLCJhZHVsdFBsdXMiLCJhZHVsdE1pbnVzIiwibnVtIiwidGV4dCIsImNhbGNTdW1PZkd1ZXN0cyIsImNoaWxkU3VtIiwiY2hpbGRQbHVzIiwiY2hpbGRNaW51cyIsImZ1bGxTdW0iLCJwYXJzZUludCIsImNvbmNhdFN0cmluZyIsInNob3ciLCJjaGVja0RhdGEiLCJzZWxlY3RlZERhdGVzIiwiZXZpY3REYXRhIiwiZ3Vlc3RzIiwiZm9ybWF0ZWRDaGVjayIsImZvcm1hdGVkRXZpY3QiLCJjb21wYXJlU3RyaW5nIiwid2luZG93Iiwib3BlbiIsImZlZWQiLCJJbnN0YWZlZWQiLCJnZXQiLCJ1c2VySWQiLCJhY2Nlc3NUb2tlbiIsInJlc29sdXRpb24iLCJsaW1pdCIsInRlbXBsYXRlIiwicnVuIiwiaGVpZ2h0IiwiYmFja1RvVG9wIiwic2Nyb2xsIiwidGhpcyIsInNjcm9sbFRvcCIsImZhZGVJbiIsImFuaW1hdGUiLCJUQUJMRVRfV0lEVEgiLCJERVNLVE9QX1dJRFRIIiwic2xpY2siLCJzbGlkZXNUb1Nob3ciLCJzbGlkZXNUb1Njcm9sbCIsImFycm93cyIsImRvdHMiLCJtb2JpbGVGaXJzdCIsInJlc3BvbnNpdmUiLCJicmVha3BvaW50Iiwic2V0dGluZ3MiLCJpbml0aWFsU2xpZGUiLCJjZW50ZXJNb2RlIiwiYXNOYXZGb3IiLCJ2YXJpYWJsZVdpZHRoIiwiZm9jdXNPblNlbGVjdCIsInNldFNsaWNrUGFyYW1ldGVycyIsImFycm93UHJldiIsImFycm93TmV4dCIsImluZmluaXRlIiwicHJldkFycm93IiwibmV4dEFycm93IiwiYmV0dGVyMSIsImJldHRlcjIiLCJiZXR0ZXIzIiwiYmV0dGVyNCIsIm1lbnUiLCJxdWVyeVNlbGVjdG9yIiwiYmV0dGVyTWVudUl0ZW1zIiwicXVlcnlTZWxlY3RvckFsbCIsImJldHRlclNsaWRlcnMiLCJldnQiLCJoYXNDbGFzcyIsInNlbGVjdG9yIiwidGFyZ2V0U2xpZGVyIiwidGFyZ2V0Q29udHJvbCIsImVhY2giLCJpIiwiZWwiLCJyZW1vdmVDbGFzcyIsImFkZENsYXNzIl0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxpQkFBQSxrQkFDQUMsaUJBQUEsa0JBTUEsU0FBQUMsUUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FDQSxJQUFBQyxFQUFBSixFQUdBLE9BRkFBLEVBQUFLLEtBQUFDLElBQUFOLEdBRUEsSUFEQUEsR0FBQSxNQUNBQSxHQUFBLEdBQ0FJLEVBQUEsSUFBQUQsRUFHQSxLQURBSCxHQUFBLElBRUFJLEVBQUEsSUFBQUgsRUFFQSxHQUFBRCxHQUFBQSxHQUFBLEVBQ0FJLEVBQUEsSUFBQUYsRUFFQUUsRUFBQSxJQUFBRCxFQU9BLFNBQUFJLFNBQUFDLEdBQ0EsSUFBQUMsRUFBQSxJQUFBQyxLQUNBQyxFQUFBLElBQUFELEtBQ0FFLEVBQUEsSUFBQUYsS0FDQUMsRUFBQUUsUUFBQUYsRUFBQUcsVUFBQSxHQUNBRixFQUFBQyxRQUFBRCxFQUFBRSxVQUFBLEdBR0FDLEVBQUEsR0FBQUMsT0FBQVIsRUFBQSxxQkFBQVMsV0FBQSxDQUNBQyxRQUFBVCxFQUNBVSxnQkFBQSxFQUNBQyxXQUFBLFFBQ0FDLFNBQUEsZ0JBQ0FDLFNBQUEsU0FBQUMsRUFBQUMsRUFBQUMsR0FDQSxHQUFBLEtBQUFELEVBQ0FDLEVBQUFDLElBQUFDLElBQUEscUJBQ0EsQ0FDQSxJQUFBQyxFQUFBQyxPQUFBTCxHQUFBTSxPQUFBLFdBQ0FMLEVBQUFDLElBQUFLLEtBQUEsUUFBQUgsR0FDQUgsRUFBQUMsSUFBQUMsSUFBQUMsR0FHQSxJQUFBSSxFQUFBLElBQUF0QixLQUFBYyxHQUNBUSxFQUFBbkIsUUFBQW1CLEVBQUFsQixVQUFBLEdBR0EsSUFBQUcsRUFBQUYsRUFBQSxHQUFBQyxPQUFBUixFQUFBLHdCQUFBUyxhQUFBZ0IsS0FBQSxjQUVBVCxHQUFBUCxFQUFBVyxNQUNBWCxFQUFBaUIsT0FBQSxVQUFBRixHQUNBZixFQUFBa0IsV0FBQUgsR0FDQWpCLEVBQUEsR0FBQUMsT0FBQVIsRUFBQSx3QkFBQW1CLElBQUFFLE9BQUFHLEdBQUFGLE9BQUEsWUFDQWYsRUFBQSxHQUFBQyxPQUFBUixFQUFBLHdCQUFBdUIsS0FBQSxRQUFBRixPQUFBRyxHQUFBRixPQUFBLGNBRUFiLEVBQUFpQixPQUFBLFVBQUFGLEdBQ0FqQixFQUFBLEdBQUFDLE9BQUFSLEVBQUEsd0JBQUFtQixJQUFBRSxPQUFBWixFQUFBVyxNQUFBRSxPQUFBLFlBQ0FmLEVBQUEsR0FBQUMsT0FBQVIsRUFBQSx3QkFBQXVCLEtBQUEsUUFBQUYsT0FBQVosRUFBQVcsTUFBQUUsT0FBQSxnQkFLQWYsRUFBQSxHQUFBQyxPQUFBUixFQUFBLHdCQUFBUyxXQUFBLENBQ0FDLFFBQUFOLEVBQ0FPLGdCQUFBLEVBQ0FDLFdBQUEsUUFDQUMsU0FBQSxnQkFDQUMsU0FBQSxTQUFBQyxFQUFBQyxFQUFBQyxHQUNBLEdBQUEsS0FBQUQsRUFDQUMsRUFBQUMsSUFBQUMsSUFBQSxxQkFDQSxDQUNBLElBQUFDLEVBQUFDLE9BQUFMLEdBQUFNLE9BQUEsV0FDQUwsRUFBQUMsSUFBQUssS0FBQSxRQUFBSCxHQUNBSCxFQUFBQyxJQUFBQyxJQUFBQyxPQVFBLElBQUFRLEVBQUFQLFNBRUFPLEVBQUFDLE9BQUEsTUFDQXRCLEVBQUEsR0FBQUMsT0FBQVIsRUFBQSxxQkFBQXVCLEtBQUEsUUFBQUYsT0FBQU8sR0FBQUUsSUFBQSxFQUFBLFFBQUFSLE9BQUEsWUFDQWYsRUFBQSxHQUFBQyxPQUFBUixFQUFBLHdCQUFBdUIsS0FBQSxRQUFBRixPQUFBTyxHQUFBRSxJQUFBLEVBQUEsUUFBQVIsT0FBQSxZQUdBZixFQUFBLEdBQUFDLE9BQUFSLEVBQUEscUJBQUFTLGFBQUFnQixLQUFBLGNBQ0FFLFdBQUF4QixHQUVBSSxFQUFBLEdBQUFDLE9BQUFSLEVBQUEsd0JBQUFTLGFBQUFnQixLQUFBLGNBQ0FFLFdBQUF2QixHQUlBLElBQUEyQixHQUFBLEVBRUF4QixFQUFBLEdBQUFDLE9BQUFSLEVBQUEsWUFBQWdDLE1BQUEsU0FBQUMsR0FDQUYsSUFDQXhCLEVBQUEsR0FBQUMsT0FBQVIsRUFBQSwyQkFBQWtDLFdBQUEsS0FDQUgsR0FBQSxLQUtBeEIsRUFBQTRCLFVBQUFDLFFBQUEsU0FBQUgsR0FDQSxJQUFBSSxFQUFBOUIsRUFBQSxHQUFBQyxPQUFBUixFQUFBLDJCQUNBLElBQUFxQyxFQUFBQyxJQUFBTCxFQUFBTSxRQUFBQyxRQUNBVCxJQUNBTSxFQUFBSSxVQUNBQyxXQUFBLFdBQ0FYLEdBQUEsR0FDQSxRQU1BLElBQUFZLEVBQUFwQyxFQUFBLEdBQUFDLE9BQUFSLEVBQUEsZ0JBQ0E0QyxFQUFBckMsRUFBQSxHQUFBQyxPQUFBUixFQUFBLGlCQUNBNkMsRUFBQXRDLEVBQUEsR0FBQUMsT0FBQVIsRUFBQSxrQkFFQTRDLEVBQUFaLE1BQUEsU0FBQUMsR0FDQSxJQUFBYSxFQUFBSCxFQUFBSSxPQUNBRCxFQUFBLElBQ0FBLElBQ0FILEVBQUFJLEtBQUFELElBR0FFLE1BR0FILEVBQUFiLE1BQUEsU0FBQUMsR0FDQSxJQUFBYSxFQUFBSCxFQUFBSSxPQUNBLEVBQUFELElBQ0FBLElBQ0FILEVBQUFJLEtBQUFELElBR0FFLE1BSUEsSUFBQUMsRUFBQTFDLEVBQUEsR0FBQUMsT0FBQVIsRUFBQSxnQkFDQWtELEVBQUEzQyxFQUFBLEdBQUFDLE9BQUFSLEVBQUEsaUJBQ0FtRCxFQUFBNUMsRUFBQSxHQUFBQyxPQUFBUixFQUFBLGtCQXNCQSxTQUFBZ0QsSUFDQSxJQUFBSSxFQUFBQyxTQUFBVixFQUFBSSxRQUFBTSxTQUFBSixFQUFBRixRQUNBTyxFQUFBL0QsUUFBQTZELEVBQUEsUUFBQSxTQUFBLFVBMkJBLE9BMUJBN0MsRUFBQSxHQUFBQyxPQUFBUixFQUFBLGVBQUErQyxLQUFBTyxHQUVBLElBQUFELFNBQUFWLEVBQUFJLFFBQ0FGLEVBQUF0QixLQUFBLFlBQUEsR0FFQXNCLEVBQUF0QixLQUFBLFlBQUEsR0FHQSxJQUFBOEIsU0FBQVYsRUFBQUksUUFDQUgsRUFBQXJCLEtBQUEsWUFBQSxHQUVBcUIsRUFBQXJCLEtBQUEsWUFBQSxHQUdBLElBQUE4QixTQUFBSixFQUFBRixRQUNBSSxFQUFBNUIsS0FBQSxZQUFBLEdBRUE0QixFQUFBNUIsS0FBQSxZQUFBLEdBR0EsSUFBQThCLFNBQUFKLEVBQUFGLFFBQ0FHLEVBQUEzQixLQUFBLFlBQUEsR0FFQTJCLEVBQUEzQixLQUFBLFlBQUEsR0FHQTZCLEVBakRBRixFQUFBbEIsTUFBQSxTQUFBQyxHQUNBLElBQUFhLEVBQUFHLEVBQUFGLE9BQ0FELEVBQUEsSUFDQUEsSUFDQUcsRUFBQUYsS0FBQUQsSUFHQUUsTUFHQUcsRUFBQW5CLE1BQUEsU0FBQUMsR0FDQSxJQUFBYSxFQUFBRyxFQUFBRixPQUNBLEVBQUFELElBQ0FBLElBQ0FHLEVBQUFGLEtBQUFELElBR0FFLE1Bb0NBekMsRUFBQSxHQUFBQyxPQUFBUixFQUFBLFlBQUFnQyxNQUFBLFNBQUFDLEdBQ0ExQixFQUFBLEdBQUFDLE9BQUFSLEVBQUEscUJBQUF5QixLQUFBLGNBQUE4QixTQUdBaEQsRUFBQSxHQUFBQyxPQUFBUixFQUFBLGVBQUFnQyxNQUFBLFNBQUFDLEdBQ0ExQixFQUFBLEdBQUFDLE9BQUFSLEVBQUEsd0JBQUF5QixLQUFBLGNBQUE4QixTQUtBaEQsRUFBQSxHQUFBQyxPQUFBUixFQUFBLG1CQUFBZ0MsTUFBQSxTQUFBQyxHQUNBLElBQUF1QixFQUFBakQsRUFBQSxHQUFBQyxPQUFBUixFQUFBLHFCQUFBeUIsS0FBQSxjQUFBZ0MsY0FDQUMsRUFBQW5ELEVBQUEsR0FBQUMsT0FBQVIsRUFBQSx3QkFBQXlCLEtBQUEsY0FBQWdDLGNBQ0FFLEVBQUFYLElBRUFZLEVBQUF2QyxPQUFBbUMsRUFBQSxJQUFBbEMsT0FBQSxjQUNBdUMsRUFBQXhDLE9BQUFxQyxFQUFBLElBQUFwQyxPQUFBLGNBQ0F3QyxFQUFBLHlFQUFBdEQsT0FBQW9ELEVBQUEsS0FBQXBELE9BQUFxRCxFQUFBLFlBQUFyRCxPQUFBbUQsR0FHQUksT0FBQUMsS0FBQUYsRUFBQSxZQWpPQS9ELFNBQUFWLGtCQUNBVSxTQUFBVCxrQkNXQSxJQUFBMkUsS0FBQSxJQUFBQyxVQUFBLENBQ0FDLElBQUEsT0FDQUMsT0FBQSxZQUNBQyxZQUFBLHVEQUNBOUIsT0FBQSxZQUNBK0IsV0FBQSxZQUNBQyxNQUFBLEdBQ0FDLFNBQUEscUNBR0FQLEtBQUFRLE1DMUJBLElBQUFGLE1BQUFoRSxFQUFBd0QsUUFBQVcsU0FBQSxFQUNBQyxVQUFBcEUsRUFBQSxXQUlBQSxFQUFBd0QsUUFBQWEsT0FBQSxXQUNBckUsRUFBQXNFLE1BQUFDLFlBQUFQLE1BQ0FJLFVBQUFJLFNBRUFKLFVBQUFsQyxZQUtBa0MsVUFBQTNDLE1BQUEsV0FFQSxPQURBekIsRUFBQSxjQUFBeUUsUUFBQSxDQUFBRixVQUFBLEdBQUEsTUFDQSxJQ2hCQSxJQUFBRyxhQUFBLElBQ0FDLGNBQUEsS0FFQTNFLEVBQUEsdUJBQUE0RSxNQUFBLENBQ0FDLGFBQUEsRUFDQUMsZUFBQSxFQUNBQyxRQUFBLEVBQ0FDLE1BQUEsRUFDQUMsYUFBQSxFQUNBQyxXQUFBLENBQ0EsQ0FDQUMsV0FBQVQsYUFDQVUsU0FBQSxjQUtBcEYsRUFBQSxzQkFBQTRFLE1BQUEsQ0FDQUMsYUFBQSxFQUNBQyxlQUFBLEVBQ0FDLFFBQUEsRUFDQUMsTUFBQSxFQUNBQyxhQUFBLEVBQ0FDLFdBQUEsQ0FDQSxDQUNBQyxXQUFBVCxhQUNBVSxTQUFBLGNBS0FwRixFQUFBLHFCQUFBNEUsTUFBQSxDQUNBQyxhQUFBLEVBQ0FDLGVBQUEsRUFDQUMsUUFBQSxFQUNBQyxNQUFBLEVBQ0FDLGFBQUEsRUFDQUMsV0FBQSxDQUNBLENBQ0FDLFdBQUFULGFBQ0FVLFNBQUEsY0FLQXBGLEVBQUEsaUJBQUE0RSxNQUFBLENBQ0FDLGFBQUEsRUFDQUMsZUFBQSxFQUNBQyxRQUFBLEVBQ0FDLE1BQUEsRUFDQUMsYUFBQSxFQUNBQyxXQUFBLENBQ0EsQ0FDQUMsV0FBQVQsYUFDQVUsU0FBQSxjQUtBcEYsRUFBQSx3QkFBQTRFLE1BQUEsQ0FDQUMsYUFBQSxFQUNBQyxlQUFBLEVBQ0FPLGFBQUEsRUFDQUMsWUFBQSxFQUNBTixNQUFBLEVBQ0FELFFBQUEsRUFDQVEsU0FBQSx1QkFDQU4sYUFBQSxFQUNBQyxXQUFBLENBQ0EsQ0FBQUMsV0FBQVQsYUFDQVUsU0FBQSxDQUNBUCxhQUFBLEVBQ0FTLFlBQUEsRUFDQUUsZUFBQSxPQU1BeEYsRUFBQSx3QkFBQTRFLE1BQUEsQ0FDQUMsYUFBQSxFQUNBQyxlQUFBLEVBQ0FPLGFBQUEsRUFDQUwsTUFBQSxFQUNBTyxTQUFBLHVCQUNBRSxlQUFBLEVBQ0FELGVBQUEsRUFDQVAsYUFBQSxFQUNBQyxXQUFBLENBQ0EsQ0FBQUMsV0FBQVQsYUFDQVUsU0FBQSxDQUNBUCxhQUFBLEVBQ0FHLE1BQUEsT0FPQSxJQUFBVSxtQkFBQSxTQUFBQyxFQUFBQyxHQXVCQSxNQXRCQSxDQUNBWCxhQUFBLEVBQ0FZLFVBQUEsRUFDQWhCLGFBQUEsRUFDQUMsZUFBQSxFQUNBVSxlQUFBLEVBQ0FSLE1BQUEsRUFDQWMsVUFBQTlGLEVBQUEyRixHQUNBSSxVQUFBL0YsRUFBQTRGLEdBQ0FWLFdBQUEsQ0FDQSxDQUFBQyxXQUFBVCxhQUNBVSxTQUFBLENBQ0FFLFlBQUEsSUFHQSxDQUFBSCxXQUFBUixjQUNBUyxTQUFBLENBQ0FQLGFBQUEsT0FRQW1CLFFBQUFOLG1CQUFBLHdCQUFBLHlCQUNBTyxRQUFBUCxtQkFBQSx3QkFBQSx5QkFDQVEsUUFBQVIsbUJBQUEsd0JBQUEseUJBQ0FTLFFBQUFULG1CQUFBLHdCQUFBLHlCQUVBMUYsRUFBQSxzQkFBQTRFLE1BQUFvQixTQUNBaEcsRUFBQSxzQkFBQTRFLE1BQUFxQixTQUNBakcsRUFBQSxzQkFBQTRFLE1BQUFzQixTQUNBbEcsRUFBQSxzQkFBQTRFLE1BQUF1QixTQUVBLElBQUFDLEtBQUF4RSxTQUFBeUUsY0FBQSxpQkFDQUMsZ0JBQUFGLEtBQUFHLGlCQUFBLHNCQUNBQyxjQUFBNUUsU0FBQTJFLGlCQUFBLG1CQUVBdkcsRUFBQSxzQkFBQXlCLE1BQUEsU0FBQWdGLEdBQ0EsSUFBQXpHLEVBQUFzRSxNQUFBb0MsU0FBQSw2QkFBQSxDQUdBLElBQUFDLEVBQUEzRyxFQUFBc0UsTUFBQXBELE9BQUFxQixJQUNBcUUsRUFBQTVHLEVBQUEsNkJBQUEyRyxFQUFBLE1BQ0FFLEVBQUE3RyxFQUFBLCtCQUFBMkcsRUFBQSxNQUVBM0csRUFBQSxtQkFBQThHLEtBQUEsU0FBQUMsRUFBQUMsR0FDQWhILEVBQUFnSCxHQUFBQyxZQUFBLDRCQUVBakgsRUFBQSxxQkFBQThHLEtBQUEsU0FBQUMsRUFBQUMsR0FDQWhILEVBQUFnSCxHQUFBQyxZQUFBLDhCQUVBakgsRUFBQSxzQkFBQThHLEtBQUEsU0FBQUMsRUFBQUMsR0FDQWhILEVBQUFnSCxHQUFBQyxZQUFBLCtCQUdBakgsRUFBQXNFLE1BQUE0QyxTQUFBLDZCQUNBTixFQUFBTSxTQUFBLDBCQUNBTCxFQUFBSyxTQUFBLDRCQUNBTixFQUFBaEMsTUFBQSIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiICAvLyDQpNC+0YDQvNC40YDRg9C10Lwg0YTQvtGA0LzRiyDQt9Cw0LrQsNC30YtcbiAgY29uc3QgaGVhZGVyRm9ybVNlbGVjdCA9ICcuaGVhZGVyX19zZWFyY2gnO1xuICBjb25zdCBmb290ZXJGb3JtU2VsZWN0ID0gJy5mb290ZXJfX3NlYXJjaCc7XG5cbiAgbWFrZUZvcm0oaGVhZGVyRm9ybVNlbGVjdCk7XG4gIG1ha2VGb3JtKGZvb3RlckZvcm1TZWxlY3QpO1xuXG4vLyDQodC60LvQvtC90LXQvdC40LVcbmZ1bmN0aW9uIGdldE5vdW4obnVtYmVyLCBvbmUsIHR3bywgZml2ZSkge1xuICBjb25zdCBpbml0TnVtYmVyID0gbnVtYmVyXG4gIG51bWJlciA9IE1hdGguYWJzKG51bWJlcilcbiAgbnVtYmVyICU9IDEwMFxuICBpZiAobnVtYmVyID49IDUgJiYgbnVtYmVyIDw9IDIwKSB7XG4gICAgcmV0dXJuIGluaXROdW1iZXIgKyAnICcgKyBmaXZlXG4gIH1cbiAgbnVtYmVyICU9IDEwXG4gIGlmIChudW1iZXIgPT09IDEpIHtcbiAgICByZXR1cm4gaW5pdE51bWJlciArICcgJyArIG9uZVxuICB9XG4gIGlmIChudW1iZXIgPj0gMiAmJiBudW1iZXIgPD0gNCkge1xuICAgIHJldHVybiBpbml0TnVtYmVyICsgJyAnICsgdHdvXG4gIH1cbiAgcmV0dXJuIGluaXROdW1iZXIgKyAnICcgKyBmaXZlXG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gLy9cbiAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDQpNC+0YDQvNCwINC/0L7QuNGB0LrQsCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gLy9cblxuICBmdW5jdGlvbiBtYWtlRm9ybShzZWxlY3Rpb24pIHtcbiAgICBjb25zdCBjdXJEYXRlID0gbmV3IERhdGUoKTtcbiAgICBjb25zdCBjaGVja0RheSA9IG5ldyBEYXRlKCk7XG4gICAgY29uc3QgZXZpY3REYXkgPSBuZXcgRGF0ZSgpO1xuICAgIGNoZWNrRGF5LnNldERhdGUoY2hlY2tEYXkuZ2V0RGF0ZSgpICsgMSk7XG4gICAgZXZpY3REYXkuc2V0RGF0ZShldmljdERheS5nZXREYXRlKCkgKyAyKTtcblxuICAgIC8vICoqKioqKioqKioqKioqKiAqKtCh0LjQvdGF0YDQvtC90LjQt9Cw0YbQuNGPINC60LDQu9C10L3QtNCw0YDQtdC5ICoqKioqKioqKioqKioqKioqKioqKioqKiAvL1xuICAgICQoYCR7c2VsZWN0aW9ufSAuY2hlY2stY2FsZW5kYXJgKS5kYXRlcGlja2VyKHtcbiAgICAgIG1pbkRhdGU6IGN1ckRhdGUsXG4gICAgICB0b2dnbGVTZWxlY3RlZDogZmFsc2UsXG4gICAgICBkYXRlRm9ybWF0OiAnZCwgTU0nLFxuICAgICAgcG9zaXRpb246IFwiYm90dG9tIGNlbnRlclwiLFxuICAgICAgb25TZWxlY3Q6IGZ1bmN0aW9uIChmZCwgZCwgcGlja2Vycykge1xuICAgICAgICBpZiAoZCA9PT0gJycpIHtcbiAgICAgICAgICBwaWNrZXJzLiRlbC52YWwoJ9CS0YvQsdC10YDQuNGC0LUg0LTQsNGC0YMnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zdCBkYXRlID0gbW9tZW50KGQpLmZvcm1hdCgnREQgTU1NTScpO1xuICAgICAgICAgIHBpY2tlcnMuJGVsLmF0dHIoJ3ZhbHVlJywgZGF0ZSk7XG4gICAgICAgICAgcGlja2Vycy4kZWwudmFsKGRhdGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdXBkTWluID0gbmV3IERhdGUoZCk7XG4gICAgICAgIHVwZE1pbi5zZXREYXRlKHVwZE1pbi5nZXREYXRlKCkgKyAxKTtcblxuICAgICAgICAvLyDQnNC10L3Rj9C10Lwg0LzQuNC9INC30L3QsNGH0LXQvdC40LUg0LIg0LrQsNC70LXQvdC00LDRgNC1INCy0YvRgdC10LvQtdC90LjRj1xuICAgICAgICBjb25zdCBkYXRlcGlja2VyID0gJChgJHtzZWxlY3Rpb259IC5ldmljdGlvbi1jYWxlbmRhcmApLmRhdGVwaWNrZXIoKS5kYXRhKCdkYXRlcGlja2VyJyk7XG5cbiAgICAgICAgaWYgKGQgPj0gZGF0ZXBpY2tlci5kYXRlKSB7XG4gICAgICAgICAgZGF0ZXBpY2tlci51cGRhdGUoJ21pbkRhdGUnLCB1cGRNaW4pO1xuICAgICAgICAgIGRhdGVwaWNrZXIuc2VsZWN0RGF0ZSh1cGRNaW4pO1xuICAgICAgICAgICQoYCR7c2VsZWN0aW9ufSAuZXZpY3Rpb24tY2FsZW5kYXJgKS52YWwobW9tZW50KHVwZE1pbikuZm9ybWF0KCdERCBNTU1NJykpXG4gICAgICAgICAgJChgJHtzZWxlY3Rpb259IC5ldmljdGlvbi1jYWxlbmRhcmApLmF0dHIoJ3ZhbHVlJywgbW9tZW50KHVwZE1pbikuZm9ybWF0KCdERCBNTU1NJykpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGF0ZXBpY2tlci51cGRhdGUoJ21pbkRhdGUnLCB1cGRNaW4pO1xuICAgICAgICAgICQoYCR7c2VsZWN0aW9ufSAuZXZpY3Rpb24tY2FsZW5kYXJgKS52YWwobW9tZW50KGRhdGVwaWNrZXIuZGF0ZSkuZm9ybWF0KCdERCBNTU1NJykpXG4gICAgICAgICAgJChgJHtzZWxlY3Rpb259IC5ldmljdGlvbi1jYWxlbmRhcmApLmF0dHIoJ3ZhbHVlJywgbW9tZW50KGRhdGVwaWNrZXIuZGF0ZSkuZm9ybWF0KCdERCBNTU1NJykpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgICQoYCR7c2VsZWN0aW9ufSAuZXZpY3Rpb24tY2FsZW5kYXJgKS5kYXRlcGlja2VyKHtcbiAgICAgIG1pbkRhdGU6IGV2aWN0RGF5LFxuICAgICAgdG9nZ2xlU2VsZWN0ZWQ6IGZhbHNlLFxuICAgICAgZGF0ZUZvcm1hdDogJ2QsIE1NJyxcbiAgICAgIHBvc2l0aW9uOiBcImJvdHRvbSBjZW50ZXJcIixcbiAgICAgIG9uU2VsZWN0OiBmdW5jdGlvbiAoZmQsIGQsIHBpY2tlcnMpIHtcbiAgICAgICAgaWYgKGQgPT09ICcnKSB7XG4gICAgICAgICAgcGlja2Vycy4kZWwudmFsKCfQktGL0LHQtdGA0LjRgtC1INC00LDRgtGDJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc3QgZGF0ZSA9IG1vbWVudChkKS5mb3JtYXQoJ0REIE1NTU0nKTtcbiAgICAgICAgICBwaWNrZXJzLiRlbC5hdHRyKCd2YWx1ZScsIGRhdGUpO1xuICAgICAgICAgIHBpY2tlcnMuJGVsLnZhbChkYXRlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogLy9cblxuICAgIC8vINCX0L3QsNGH0LXQvdC40Y8g0L/Qvi3Rg9C80L7Qu9GH0LDQvdC40Y5cbiAgICBjb25zdCBkZWZEYXkgPSBtb21lbnQoKTtcblxuICAgIGRlZkRheS5sb2NhbGUoJ3J1JylcbiAgICAkKGAke3NlbGVjdGlvbn0gLmNoZWNrLWNhbGVuZGFyYCkuYXR0cigndmFsdWUnLCBtb21lbnQoZGVmRGF5KS5hZGQoMSwgJ2RheXMnKS5mb3JtYXQoJ0REIE1NTU0nKSk7XG4gICAgJChgJHtzZWxlY3Rpb259IC5ldmljdGlvbi1jYWxlbmRhcmApLmF0dHIoJ3ZhbHVlJywgbW9tZW50KGRlZkRheSkuYWRkKDIsICdkYXlzJykuZm9ybWF0KCdERCBNTU1NJykpO1xuXG5cbiAgICBjb25zdCBjaGVja0NhbGVuZGFyID0gJChgJHtzZWxlY3Rpb259IC5jaGVjay1jYWxlbmRhcmApLmRhdGVwaWNrZXIoKS5kYXRhKCdkYXRlcGlja2VyJyk7XG4gICAgY2hlY2tDYWxlbmRhci5zZWxlY3REYXRlKGNoZWNrRGF5KTtcblxuICAgIGNvbnN0IGV2aWN0aW9uQ2FsZW5kYXIgPSAkKGAke3NlbGVjdGlvbn0gLmV2aWN0aW9uLWNhbGVuZGFyYCkuZGF0ZXBpY2tlcigpLmRhdGEoJ2RhdGVwaWNrZXInKTtcbiAgICBldmljdGlvbkNhbGVuZGFyLnNlbGVjdERhdGUoZXZpY3REYXkpO1xuXG4gICAgLy8gKioqKioqKioqKioqINCa0L7Qu9C40YfQtdGB0YLQstC+INCz0L7RgdGC0LXQuSAqKioqKioqKioqKioqKioqIC8vXG4gICAgLy8g0JLRi9C/0LDQtNCw0Y7RidC10LUg0LzQtdC90Y5cbiAgICBsZXQgb3BlbmVkID0gZmFsc2U7XG5cbiAgICAkKGAke3NlbGVjdGlvbn0gLmd1ZXN0YCkuY2xpY2soKGUpID0+IHtcbiAgICAgIGlmICghb3BlbmVkKSB7XG4gICAgICAgICQoYCR7c2VsZWN0aW9ufSAuc2VhcmNoX19ndWVzdC1jaGFuZ2VgKS5mYWRlVG9nZ2xlKDIwMCk7XG4gICAgICAgIG9wZW5lZCA9IHRydWU7XG4gICAgICB9XG4gICAgfSlcblxuICAgIC8vINCh0LrRgNGL0YLQuNC1INC/0YDQuCDQutC70LjQutC1INCy0L3QtSDQvtC60L3QsFxuICAgICQoZG9jdW1lbnQpLm1vdXNldXAoZnVuY3Rpb24gKGUpIHtcbiAgICAgIHZhciBjb250YWluZXIgPSAkKGAke3NlbGVjdGlvbn0gLnNlYXJjaF9fZ3Vlc3QtY2hhbmdlYCk7XG4gICAgICBpZiAoY29udGFpbmVyLmhhcyhlLnRhcmdldCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGlmIChvcGVuZWQpIHtcbiAgICAgICAgICBjb250YWluZXIuZmFkZU91dCgpO1xuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgb3BlbmVkID0gZmFsc2U7XG4gICAgICAgICAgfSwgMjAwKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyDQktC30YDQvtGB0LvRi9C1XG4gICAgY29uc3QgYWR1bHRTdW0gPSAkKGAke3NlbGVjdGlvbn0gLmFkdWx0LXN1bWApO1xuICAgIGNvbnN0IGFkdWx0UGx1cyA9ICQoYCR7c2VsZWN0aW9ufSAuYWR1bHQtcGx1c2ApO1xuICAgIGNvbnN0IGFkdWx0TWludXMgPSAkKGAke3NlbGVjdGlvbn0gLmFkdWx0LW1pbnVzYCk7XG5cbiAgICBhZHVsdFBsdXMuY2xpY2soKGUpID0+IHtcbiAgICAgIGxldCBudW0gPSBhZHVsdFN1bS50ZXh0KClcbiAgICAgIGlmIChudW0gPCA2KSB7XG4gICAgICAgIG51bSsrO1xuICAgICAgICBhZHVsdFN1bS50ZXh0KG51bSlcbiAgICAgIH1cblxuICAgICAgY2FsY1N1bU9mR3Vlc3RzKCk7XG4gICAgfSk7XG5cbiAgICBhZHVsdE1pbnVzLmNsaWNrKChlKSA9PiB7XG4gICAgICBsZXQgbnVtID0gYWR1bHRTdW0udGV4dCgpXG4gICAgICBpZiAobnVtID4gMSkge1xuICAgICAgICBudW0tLTtcbiAgICAgICAgYWR1bHRTdW0udGV4dChudW0pXG4gICAgICB9XG5cbiAgICAgIGNhbGNTdW1PZkd1ZXN0cygpO1xuICAgIH0pO1xuXG4gICAgLy8g0JTQtdGC0LhcbiAgICBjb25zdCBjaGlsZFN1bSA9ICQoYCR7c2VsZWN0aW9ufSAuY2hpbGQtc3VtYCk7XG4gICAgY29uc3QgY2hpbGRQbHVzID0gJChgJHtzZWxlY3Rpb259IC5jaGlsZC1wbHVzYCk7XG4gICAgY29uc3QgY2hpbGRNaW51cyA9ICQoYCR7c2VsZWN0aW9ufSAuY2hpbGQtbWludXNgKTtcblxuICAgIGNoaWxkUGx1cy5jbGljaygoZSkgPT4ge1xuICAgICAgbGV0IG51bSA9IGNoaWxkU3VtLnRleHQoKVxuICAgICAgaWYgKG51bSA8IDUpIHtcbiAgICAgICAgbnVtKys7XG4gICAgICAgIGNoaWxkU3VtLnRleHQobnVtKVxuICAgICAgfVxuXG4gICAgICBjYWxjU3VtT2ZHdWVzdHMoKTtcbiAgICB9KTtcblxuICAgIGNoaWxkTWludXMuY2xpY2soKGUpID0+IHtcbiAgICAgIGxldCBudW0gPSBjaGlsZFN1bS50ZXh0KClcbiAgICAgIGlmIChudW0gPiAwKSB7XG4gICAgICAgIG51bS0tO1xuICAgICAgICBjaGlsZFN1bS50ZXh0KG51bSlcbiAgICAgIH1cblxuICAgICAgY2FsY1N1bU9mR3Vlc3RzKCk7XG4gICAgfSk7XG5cbiAgICBmdW5jdGlvbiBjYWxjU3VtT2ZHdWVzdHMoKSB7XG4gICAgICBjb25zdCBmdWxsU3VtID0gcGFyc2VJbnQoYWR1bHRTdW0udGV4dCgpKSArIHBhcnNlSW50KGNoaWxkU3VtLnRleHQoKSk7XG4gICAgICBjb25zdCBjb25jYXRTdHJpbmcgPSBnZXROb3VuKGZ1bGxTdW0sICfQs9C+0YHRgtGPJywgJ9Cz0L7RgdGC0LXQuScsICfQs9C+0YHRgtC10LknKTtcbiAgICAgICQoYCR7c2VsZWN0aW9ufSAuZnVsbC1zdW1gKS50ZXh0KGNvbmNhdFN0cmluZyk7XG5cbiAgICAgIGlmIChwYXJzZUludChhZHVsdFN1bS50ZXh0KCkpID09PSAxKSB7XG4gICAgICAgIGFkdWx0TWludXMuYXR0cignZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFkdWx0TWludXMuYXR0cignZGlzYWJsZWQnLCBmYWxzZSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChwYXJzZUludChhZHVsdFN1bS50ZXh0KCkpID09PSA2KSB7XG4gICAgICAgIGFkdWx0UGx1cy5hdHRyKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYWR1bHRQbHVzLmF0dHIoJ2Rpc2FibGVkJywgZmFsc2UpO1xuICAgICAgfVxuXG4gICAgICBpZiAocGFyc2VJbnQoY2hpbGRTdW0udGV4dCgpKSA9PT0gMCkge1xuICAgICAgICBjaGlsZE1pbnVzLmF0dHIoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjaGlsZE1pbnVzLmF0dHIoJ2Rpc2FibGVkJywgZmFsc2UpO1xuICAgICAgfVxuXG4gICAgICBpZiAocGFyc2VJbnQoY2hpbGRTdW0udGV4dCgpKSA9PT0gNSkge1xuICAgICAgICBjaGlsZFBsdXMuYXR0cignZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNoaWxkUGx1cy5hdHRyKCdkaXNhYmxlZCcsIGZhbHNlKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZ1bGxTdW1cbiAgICB9XG5cblxuICAgICQoYCR7c2VsZWN0aW9ufSAuY2hlY2tgKS5jbGljaygoZSkgPT4ge1xuICAgICAgJChgJHtzZWxlY3Rpb259IC5jaGVjay1jYWxlbmRhcmApLmRhdGEoJ2RhdGVwaWNrZXInKS5zaG93KCk7XG4gICAgfSlcblxuICAgICQoYCR7c2VsZWN0aW9ufSAuZXZpY3Rpb25gKS5jbGljaygoZSkgPT4ge1xuICAgICAgJChgJHtzZWxlY3Rpb259IC5ldmljdGlvbi1jYWxlbmRhcmApLmRhdGEoJ2RhdGVwaWNrZXInKS5zaG93KCk7XG4gICAgfSlcblxuICAgIC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogLy9cblxuICAgICQoYCR7c2VsZWN0aW9ufSAuc2VhcmNoX19nb3RvYCkuY2xpY2soKGUpID0+IHtcbiAgICAgIGNvbnN0IGNoZWNrRGF0YSA9ICQoYCR7c2VsZWN0aW9ufSAuY2hlY2stY2FsZW5kYXJgKS5kYXRhKCdkYXRlcGlja2VyJykuc2VsZWN0ZWREYXRlcztcbiAgICAgIGNvbnN0IGV2aWN0RGF0YSA9ICQoYCR7c2VsZWN0aW9ufSAuZXZpY3Rpb24tY2FsZW5kYXJgKS5kYXRhKCdkYXRlcGlja2VyJykuc2VsZWN0ZWREYXRlcztcbiAgICAgIGNvbnN0IGd1ZXN0cyA9IGNhbGNTdW1PZkd1ZXN0cygpO1xuXG4gICAgICBjb25zdCBmb3JtYXRlZENoZWNrID0gbW9tZW50KGNoZWNrRGF0YVswXSkuZm9ybWF0KCdERC5NTS5ZWVlZJyk7XG4gICAgICBjb25zdCBmb3JtYXRlZEV2aWN0ID0gbW9tZW50KGV2aWN0RGF0YVswXSkuZm9ybWF0KCdERC5NTS5ZWVlZJyk7XG4gICAgICBjb25zdCBjb21wYXJlU3RyaW5nID0gYGh0dHBzOi8vb3N0cm92b2sucnUvaG90ZWwvdW5pdGVkX2FyYWJfZW1pcmF0ZXMvYWJ1X2RoYWJpLz9xPTQ1MyZkYXRlcz0ke2Zvcm1hdGVkQ2hlY2t9LSR7Zm9ybWF0ZWRFdmljdH0mZ3Vlc3RzPSR7Z3Vlc3RzfWBcblxuICAgICAgLy8gd2luZG93LmxvY2F0aW9uLmhyZWYgPSBjb21wYXJlU3RyaW5nO1xuICAgICAgd2luZG93Lm9wZW4oY29tcGFyZVN0cmluZywgJ19ibGFuaycpO1xuICAgICAgLy8gY29uc29sZS5sb2coZm9ybWF0ZWRDaGVjaylcbiAgICAgIC8vIGNvbnNvbGUubG9nKGZvcm1hdGVkRXZpY3QpXG4gICAgICAvLyBjb25zb2xlLmxvZyhndWVzdHMpXG4gICAgICAvLyBjb25zb2xlLmxvZyhjb21wYXJlU3RyaW5nKVxuICAgIH0pXG4gIH1cbiIsIi8qY29uc3QgdGFibGV0V2lkdGggPSB3aW5kb3cubWF0Y2hNZWRpYShcIihtaW4td2lkdGg6IDc2OHB4KVwiKTtcbmNvbnN0IGRlc2t0b3BXaWR0aCA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1pbi13aWR0aDogMTIwMHB4KVwiKTtcbmNvbnN0IGRlc2t0b3BXaWR0aE1heCA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1pbi13aWR0aDogMTkyMHB4KVwiKTtcblxubGV0IGxpbWl0SW1hZ2VzID0gOTtcblxuaWYgKGRlc2t0b3BXaWR0aE1heC5tYXRjaGVzKSB7XG4gICAgbGltaXRJbWFnZXMgPSAxNjtcbiAgfSBlbHNlIGlmIChkZXNrdG9wV2lkdGgubWF0Y2hlcykge1xuICAgIGxpbWl0SW1hZ2VzID0gMTI7XG4gIH0gZWxzZSBpZiAodGFibGV0V2lkdGgubWF0Y2hlcykge1xuICAgIGxpbWl0SW1hZ2VzID0gMTA7XG4gIH0gZWxzZSB7XG4gICAgbGltaXRJbWFnZXMgPSA5O1xuICB9ICovXG5cbmNvbnN0IGZlZWQgPSBuZXcgSW5zdGFmZWVkKHtcbiAgZ2V0OiAndXNlcicsXG4gIHVzZXJJZDogMTQxMTA0ODYwNzAsXG4gIGFjY2Vzc1Rva2VuOiAnMTQxMTA0ODYwNzAuMTY3N2VkMC5lMjlmMzkwZDU0MjU0OGNjOWQzODM5NTRmZjJiMmYzYScsXG4gIHRhcmdldDogJ0luc3RhZmVlZCcsXG4gIHJlc29sdXRpb246ICd0aHVtYm5haWwnLFxuICBsaW1pdDogMjIsXG4gIHRlbXBsYXRlOiAnPGxpPjxpbWcgc3JjPVwie3tpbWFnZX19XCIgLz48L2xpPicsXG59KTtcblxuZmVlZC5ydW4oKTtcbiIsIiAgY29uc3QgbGltaXQgPSAkKHdpbmRvdykuaGVpZ2h0KCkgLyA0O1xuICBjb25zdCBiYWNrVG9Ub3AgPSAkKCcjdXAtYnRuJyk7XG5cbiAgLy8gQXBwZWFyaW5nIGFuZCBkaXNhcHBlYXJpbmcgb2YgdGhlICd1cCcgYnV0dG9uIG9uIHRoZSBmaXJzdCBzY3JlZW5cbiAgLy8gYW5kIGZpeGVkIG1lbnUgb24gdG9wIHNjcmVlblxuICAkKHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoJCh0aGlzKS5zY3JvbGxUb3AoKSA+IGxpbWl0KSB7XG4gICAgICBiYWNrVG9Ub3AuZmFkZUluKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJhY2tUb1RvcC5mYWRlT3V0KCk7XG4gICAgfVxuICB9KTtcblxuICAgLy8gU29mdCBzY3JvbGwgdG8gdGhlIHRvcFxuICBiYWNrVG9Ub3AuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICQoJ2JvZHksIGh0bWwnKS5hbmltYXRlKHtzY3JvbGxUb3A6IDB9LCAxMDApO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfSk7XG4iLCJjb25zdCBUQUJMRVRfV0lEVEggPSA3NjggLSAxO1xuY29uc3QgREVTS1RPUF9XSURUSCA9IDExOTAgLSAxO1xuXG4kKCcuYWR2YW50YWdlc19fc2xpZGVyJykuc2xpY2soe1xuICBzbGlkZXNUb1Nob3c6IDEsXG4gIHNsaWRlc1RvU2Nyb2xsOiAxLFxuICBhcnJvd3M6IGZhbHNlLFxuICBkb3RzOiB0cnVlLFxuICBtb2JpbGVGaXJzdDogdHJ1ZSxcbiAgcmVzcG9uc2l2ZTogW1xuICAgIHtcbiAgICAgIGJyZWFrcG9pbnQ6IFRBQkxFVF9XSURUSCxcbiAgICAgIHNldHRpbmdzOiAndW5zbGljaydcbiAgICB9XG4gIF1cbn0pO1xuXG4kKCcudHJhbnNwb3J0X19zbGlkZXInKS5zbGljayh7XG4gIHNsaWRlc1RvU2hvdzogMSxcbiAgc2xpZGVzVG9TY3JvbGw6IDEsXG4gIGFycm93czogZmFsc2UsXG4gIGRvdHM6IHRydWUsXG4gIG1vYmlsZUZpcnN0OiB0cnVlLFxuICByZXNwb25zaXZlOiBbXG4gICAge1xuICAgICAgYnJlYWtwb2ludDogVEFCTEVUX1dJRFRILFxuICAgICAgc2V0dGluZ3M6ICd1bnNsaWNrJ1xuICAgIH1cbiAgXVxufSk7XG5cbiQoJy5saWZlaGFja19fc2xpZGVyJykuc2xpY2soe1xuICBzbGlkZXNUb1Nob3c6IDEsXG4gIHNsaWRlc1RvU2Nyb2xsOiAxLFxuICBhcnJvd3M6IGZhbHNlLFxuICBkb3RzOiB0cnVlLFxuICBtb2JpbGVGaXJzdDogdHJ1ZSxcbiAgcmVzcG9uc2l2ZTogW1xuICAgIHtcbiAgICAgIGJyZWFrcG9pbnQ6IFRBQkxFVF9XSURUSCxcbiAgICAgIHNldHRpbmdzOiAndW5zbGljaydcbiAgICB9XG4gIF1cbn0pO1xuXG4kKCcuc3RvcF9fc2xpZGVyJykuc2xpY2soe1xuICBzbGlkZXNUb1Nob3c6IDEsXG4gIHNsaWRlc1RvU2Nyb2xsOiAxLFxuICBhcnJvd3M6IGZhbHNlLFxuICBkb3RzOiB0cnVlLFxuICBtb2JpbGVGaXJzdDogdHJ1ZSxcbiAgcmVzcG9uc2l2ZTogW1xuICAgIHtcbiAgICAgIGJyZWFrcG9pbnQ6IFRBQkxFVF9XSURUSCxcbiAgICAgIHNldHRpbmdzOiAndW5zbGljaydcbiAgICB9XG4gIF1cbn0pO1xuXG4kKCcuZGV0YWlsc19fc2xpZGVyLWZvcicpLnNsaWNrKHtcbiAgc2xpZGVzVG9TaG93OiAxLFxuICBzbGlkZXNUb1Njcm9sbDogMSxcbiAgaW5pdGlhbFNsaWRlOiAyLFxuICBjZW50ZXJNb2RlOiBmYWxzZSxcbiAgZG90czogdHJ1ZSxcbiAgYXJyb3dzOiBmYWxzZSxcbiAgYXNOYXZGb3I6ICcuZGV0YWlsc19fc2xpZGVyLW5hdicsXG4gIG1vYmlsZUZpcnN0OiB0cnVlLFxuICByZXNwb25zaXZlOiBbXG4gICAgeyBicmVha3BvaW50OiBUQUJMRVRfV0lEVEgsXG4gICAgICBzZXR0aW5nczoge1xuICAgICAgICBzbGlkZXNUb1Nob3c6IDEsXG4gICAgICAgIGNlbnRlck1vZGU6IHRydWUsXG4gICAgICAgIHZhcmlhYmxlV2lkdGg6IHRydWVcbiAgICAgIH1cbiAgICB9XG4gIF1cbn0pO1xuXG4kKCcuZGV0YWlsc19fc2xpZGVyLW5hdicpLnNsaWNrKHtcbiAgc2xpZGVzVG9TaG93OiA0LFxuICBzbGlkZXNUb1Njcm9sbDogMSxcbiAgaW5pdGlhbFNsaWRlOiAyLFxuICBkb3RzOiBmYWxzZSxcbiAgYXNOYXZGb3I6ICcuZGV0YWlsc19fc2xpZGVyLWZvcicsXG4gIGZvY3VzT25TZWxlY3Q6IHRydWUsXG4gIHZhcmlhYmxlV2lkdGg6IHRydWUsXG4gIG1vYmlsZUZpcnN0OiB0cnVlLFxuICByZXNwb25zaXZlOiBbXG4gICAgeyBicmVha3BvaW50OiBUQUJMRVRfV0lEVEgsXG4gICAgICBzZXR0aW5nczoge1xuICAgICAgICBzbGlkZXNUb1Nob3c6IDYsXG4gICAgICAgIGRvdHM6IHRydWUsXG4gICAgICB9XG4gICAgfVxuICBdXG59KTtcblxuLy8g0J/QsNGA0LDQvNC10YLRgNGLINGB0LvQsNC50LTQtdGA0L7QsiDQtNC+0YHRgtC+0L/RgNC40LzQtdGH0LDRgtC10LvRjNC90L7RgdGC0LXQuVxuY29uc3Qgc2V0U2xpY2tQYXJhbWV0ZXJzID0gZnVuY3Rpb24oYXJyb3dQcmV2LCBhcnJvd05leHQpIHtcbiAgY29uc3Qgc2xpY2tQYXJhbWV0ZXJzID0ge1xuICAgIG1vYmlsZUZpcnN0OiB0cnVlLFxuICAgIGluZmluaXRlOiB0cnVlLFxuICAgIHNsaWRlc1RvU2hvdzogMSxcbiAgICBzbGlkZXNUb1Njcm9sbDogMSxcbiAgICB2YXJpYWJsZVdpZHRoOiB0cnVlLFxuICAgIGRvdHM6IGZhbHNlLFxuICAgIHByZXZBcnJvdzogJChhcnJvd1ByZXYpLFxuICAgIG5leHRBcnJvdzogJChhcnJvd05leHQpLFxuICAgIHJlc3BvbnNpdmU6IFtcbiAgICAgIHsgYnJlYWtwb2ludDogVEFCTEVUX1dJRFRILFxuICAgICAgICBzZXR0aW5nczoge1xuICAgICAgICAgIGNlbnRlck1vZGU6IGZhbHNlXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB7IGJyZWFrcG9pbnQ6IERFU0tUT1BfV0lEVEgsXG4gICAgICAgIHNldHRpbmdzOiB7XG4gICAgICAgICAgc2xpZGVzVG9TaG93OiAxLFxuICAgICAgICB9XG4gICAgICB9XG4gICAgXVxuICB9XG4gIHJldHVybiBzbGlja1BhcmFtZXRlcnM7XG59O1xuXG5jb25zdCBiZXR0ZXIxID0gc2V0U2xpY2tQYXJhbWV0ZXJzKCcuYmV0dGVyX19hcnJvdy0tcHJldjEnLCAnLmJldHRlcl9fYXJyb3ctLW5leHQxJyk7XG5jb25zdCBiZXR0ZXIyID0gc2V0U2xpY2tQYXJhbWV0ZXJzKCcuYmV0dGVyX19hcnJvdy0tcHJldjInLCAnLmJldHRlcl9fYXJyb3ctLW5leHQyJyk7XG5jb25zdCBiZXR0ZXIzID0gc2V0U2xpY2tQYXJhbWV0ZXJzKCcuYmV0dGVyX19hcnJvdy0tcHJldjMnLCAnLmJldHRlcl9fYXJyb3ctLW5leHQzJyk7XG5jb25zdCBiZXR0ZXI0ID0gc2V0U2xpY2tQYXJhbWV0ZXJzKCcuYmV0dGVyX19hcnJvdy0tcHJldjQnLCAnLmJldHRlcl9fYXJyb3ctLW5leHQ0Jyk7XG5cbiQoJy5iZXR0ZXJfX3NsaWRlci0tMScpLnNsaWNrKGJldHRlcjEpO1xuJCgnLmJldHRlcl9fc2xpZGVyLS0yJykuc2xpY2soYmV0dGVyMik7XG4kKCcuYmV0dGVyX19zbGlkZXItLTMnKS5zbGljayhiZXR0ZXIzKTtcbiQoJy5iZXR0ZXJfX3NsaWRlci0tNCcpLnNsaWNrKGJldHRlcjQpO1xuXG5jb25zdCBtZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJldHRlcl9fbWVudScpO1xuY29uc3QgYmV0dGVyTWVudUl0ZW1zID0gbWVudS5xdWVyeVNlbGVjdG9yQWxsKCcuYmV0dGVyX19tZW51LWl0ZW0nKTtcbmNvbnN0IGJldHRlclNsaWRlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYmV0dGVyX19zbGlkZXInKTtcblxuJCgnLmJldHRlcl9fbWVudS1pdGVtJykuY2xpY2soZnVuY3Rpb24gKGV2dCkge1xuICBpZiAoJCh0aGlzKS5oYXNDbGFzcygnYmV0dGVyX19tZW51LWl0ZW0tLWFjdGl2ZScpKSB7XG4gICAgcmV0dXJuO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IHNlbGVjdG9yID0gJCh0aGlzKS5kYXRhKCkubnVtO1xuICAgIGNvbnN0IHRhcmdldFNsaWRlciA9ICQoJy5iZXR0ZXJfX3NsaWRlcltkYXRhLW51bT1cIicgKyBzZWxlY3RvciArICdcIl0nKTsgLy8g0KHQtdC70LXQutGCINC90YPQttC90L7Qs9C+INCx0LvQvtC60LBcbiAgICBjb25zdCB0YXJnZXRDb250cm9sID0gJCgnLmJldHRlcl9fY29udHJvbHNbZGF0YS1udW09XCInICsgc2VsZWN0b3IgKyAnXCJdJyk7XG5cbiAgICAkKCcuYmV0dGVyX19zbGlkZXInKS5lYWNoKGZ1bmN0aW9uIChpLCBlbCkge1xuICAgICAgJChlbCkucmVtb3ZlQ2xhc3MoJ2JldHRlcl9fc2xpZGVyLS1hY3RpdmUnKTtcbiAgICB9KTtcbiAgICAkKCcuYmV0dGVyX19jb250cm9scycpLmVhY2goZnVuY3Rpb24gKGksIGVsKSB7XG4gICAgICAkKGVsKS5yZW1vdmVDbGFzcygnYmV0dGVyX19jb250cm9scy0tYWN0aXZlJyk7XG4gICAgfSk7XG4gICAgJCgnLmJldHRlcl9fbWVudS1pdGVtJykuZWFjaChmdW5jdGlvbiAoaSwgZWwpIHtcbiAgICAgICQoZWwpLnJlbW92ZUNsYXNzKCdiZXR0ZXJfX21lbnUtaXRlbS0tYWN0aXZlJyk7XG4gICAgfSk7XG5cbiAgICAkKHRoaXMpLmFkZENsYXNzKCdiZXR0ZXJfX21lbnUtaXRlbS0tYWN0aXZlJyk7XG4gICAgdGFyZ2V0U2xpZGVyLmFkZENsYXNzKCdiZXR0ZXJfX3NsaWRlci0tYWN0aXZlJyk7XG4gICAgdGFyZ2V0Q29udHJvbC5hZGRDbGFzcygnYmV0dGVyX19jb250cm9scy0tYWN0aXZlJyk7XG4gICAgdGFyZ2V0U2xpZGVyLnNsaWNrKCdyZWZyZXNoJyk7XG4gIH1cbn0pO1xuIl19
